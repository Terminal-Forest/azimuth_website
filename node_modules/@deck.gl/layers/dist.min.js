!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("deck"),require("luma")):"function"==typeof define&&define.amd?define(["deck","luma"],e):"object"==typeof exports?exports.deck=e(require("deck"),require("luma")):t.deck=e(t.deck,t.luma)}(window,(function(t,e){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=31)}([function(t,e,n){t.exports=n(36)},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(e,n){e.exports=t},function(t,e,n){var r=n(32);function i(e,n,o){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=i=Reflect.get:t.exports=i=function(t,e,n){var i=r(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}},i(e,n,o||e)}t.exports=i},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(t,n){t.exports=e},function(t,e,n){var r=n(33);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},function(t,e,n){var r=n(34),i=n(35);t.exports=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?i(t):e}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.d(e,"a",(function(){return r}))},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}n.d(e,"a",(function(){return i}))},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",(function(){return r}))},,function(t,e){},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(16);function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function o(t,e,n){return(o=i()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&Object(r.a)(o,n.prototype),o}).apply(null,arguments)}},function(t,e,n){"use strict";function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function r(t,e,n){n=n||2;var r,s,c,u,l,h,d,v=e&&e.length,y=v?e[0]*n:t.length,m=i(t,0,y,n,!0),x=[];if(!m||m.next===m.prev)return x;if(v&&(m=function(t,e,n,r){var a,s,c,u,l,h=[];for(a=0,s=e.length;a<s;a++)c=e[a]*r,u=a<s-1?e[a+1]*r:t.length,(l=i(t,c,u,r,!1))===l.next&&(l.steiner=!0),h.push(g(l));for(h.sort(f),a=0;a<h.length;a++)p(h[a],n),n=o(n,n.next);return n}(t,e,m,n)),t.length>80*n){r=c=t[0],s=u=t[1];for(var b=n;b<y;b+=n)(l=t[b])<r&&(r=l),(h=t[b+1])<s&&(s=h),l>c&&(c=l),h>u&&(u=h);d=0!==(d=Math.max(c-r,u-s))?1/d:0}return a(m,x,n,r,s,d),x}function i(t,e,n,r,i){var o,a;if(i===M(t,e,n,r)>0)for(o=e;o<n;o+=r)a=C(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=C(o,t[o],t[o+1],a);return a&&x(a,a.next)&&(O(a),a=a.next),a}function o(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!x(r,r.next)&&0!==m(r.prev,r,r.next))r=r.next;else{if(O(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function a(t,e,n,r,i,f,p){if(t){!p&&f&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=d(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,c,u=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<u&&(s++,r=r.nextZ);e++);for(c=u;s>0||c>0&&r;)0!==s&&(0===c||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,c--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(a>1)}(i)}(t,r,i,f);for(var h,g,v=t;t.prev!==t.next;)if(h=t.prev,g=t.next,f?c(t,r,i,f):s(t))e.push(h.i/n),e.push(t.i/n),e.push(g.i/n),O(t),t=g.next,v=g.next;else if((t=g)===v){p?1===p?a(t=u(o(t),e,n),e,n,r,i,f,2):2===p&&l(t,e,n,r,i,f):a(o(t),e,n,r,i,f,1);break}}}function s(t){var e=t.prev,n=t,r=t.next;if(m(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(v(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&m(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function c(t,e,n,r){var i=t.prev,o=t,a=t.next;if(m(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,c=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,u=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,f=d(s,c,e,n,r),p=d(u,l,e,n,r),h=t.prevZ,g=t.nextZ;h&&h.z>=f&&g&&g.z<=p;){if(h!==t.prev&&h!==t.next&&v(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&m(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,g!==t.prev&&g!==t.next&&v(i.x,i.y,o.x,o.y,a.x,a.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.nextZ}for(;h&&h.z>=f;){if(h!==t.prev&&h!==t.next&&v(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&m(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;g&&g.z<=p;){if(g!==t.prev&&g!==t.next&&v(i.x,i.y,o.x,o.y,a.x,a.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.nextZ}return!0}function u(t,e,n){var r=t;do{var i=r.prev,a=r.next.next;!x(i,a)&&b(i,r,r.next,a)&&S(i,a)&&S(a,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(a.i/n),O(r),O(r.next),r=t=a),r=r.next}while(r!==t);return o(r)}function l(t,e,n,r,i,s){var c=t;do{for(var u=c.next.next;u!==c.prev;){if(c.i!==u.i&&y(c,u)){var l=_(c,u);return c=o(c,c.next),l=o(l,l.next),a(c,e,n,r,i,s),void a(l,e,n,r,i,s)}u=u.next}c=c.next}while(c!==t)}function f(t,e){return t.x-e.x}function p(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n;var c,u=n,l=n.x,f=n.y,p=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&v(o<f?i:a,o,l,f,o<f?a:i,o,r.x,r.y)&&(c=Math.abs(o-r.y)/(i-r.x),S(r,t)&&(c<p||c===p&&(r.x>n.x||r.x===n.x&&h(n,r)))&&(n=r,p=c)),r=r.next}while(r!==u);return n}(t,e)){var n=_(e,t);o(n,n.next)}}function h(t,e){return m(t.prev,t,e.prev)<0&&m(e.next,t,t.next)<0}function d(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function g(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function v(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function y(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&b(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(S(t,e)&&S(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(m(t.prev,t,e.prev)||m(t,e.prev,e))||x(t,e)&&m(t.prev,t,t.next)>0&&m(e.prev,e,e.next)>0)}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function x(t,e){return t.x===e.x&&t.y===e.y}function b(t,e,n,r){var i=P(m(t,e,n)),o=P(m(t,e,r)),a=P(m(n,r,t)),s=P(m(n,r,e));return i!==o&&a!==s||(!(0!==i||!w(t,n,e))||(!(0!==o||!w(t,r,e))||(!(0!==a||!w(n,t,r))||!(0!==s||!w(n,e,r)))))}function w(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function P(t){return t>0?1:t<0?-1:0}function S(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function _(t,e){var n=new L(t.i,t.x,t.y),r=new L(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function C(t,e,n,r){var i=new L(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function O(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function L(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function M(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}t.exports=r,t.exports.default=r,r.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,a=Math.abs(M(t,0,o,n));if(i)for(var s=0,c=e.length;s<c;s++){var u=e[s]*n,l=s<c-1?e[s+1]*n:t.length;a-=Math.abs(M(t,u,l,n))}var f=0;for(s=0;s<r.length;s+=3){var p=r[s]*n,h=r[s+1]*n,d=r[s+2]*n;f+=Math.abs((t[p]-t[d])*(t[h+1]-t[p+1])-(t[p]-t[h])*(t[d+1]-t[p+1]))}return 0===a&&0===f?0:Math.abs((f-a)/a)},r.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},function(t,e,n){var r=n(37),i=n(38),o=n(39);t.exports=function(t,e){return r(t)||i(t,e)||o()}},function(t,e,n){"use strict";t.exports=r,t.exports.default=r;function r(t,e,n,r,i,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function i(t,e,n,r,i,a,s){for(var c=0;c<e;c++){for(var u=0;u<n;u++)r[u]=t[u*e+c];for(o(r,i,a,s,n),u=0;u<n;u++)t[u*e+c]=i[u]}for(u=0;u<n;u++){for(c=0;c<e;c++)r[c]=t[u*e+c];for(o(r,i,a,s,e),c=0;c<e;c++)t[u*e+c]=Math.sqrt(i[c])}}function o(t,e,n,r,i){n[0]=0,r[0]=-1e20,r[1]=1e20;for(var o=1,a=0;o<i;o++){for(var s=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);s<=r[a];)a--,s=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);n[++a]=o,r[a]=s,r[a+1]=1e20}for(o=0,a=0;o<i;o++){for(;r[a+1]<o;)a++;e[o]=(o-n[a])*(o-n[a])+t[n[a]]}}r.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),r=0;r<this.size*this.size;r++){var o=e.data[4*r+3]/255;this.gridOuter[r]=1===o?0:0===o?1e20:Math.pow(Math.max(0,.5-o),2),this.gridInner[r]=1===o?1e20:0===o?0:Math.pow(Math.max(0,o-.5),2)}for(i(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),i(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),r=0;r<this.size*this.size;r++){var a=this.gridOuter[r]-this.gridInner[r];n[r]=Math.max(0,Math.min(255,Math.round(255-255*(a/this.radius+this.cutoff))))}return n}},,,,,,,,,,,,function(t,e,n){var r=n(40),i=("undefined"==typeof window?global:window).deck||{};if(!i.Layer)throw new Error("@deck.gl/core is not found");t.exports=Object.assign(i,r)},function(t,e,n){var r=n(1);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t}},function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,r)}t.exports=n},function(t,e){function n(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=n=function(t){return typeof t}:t.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(e)}t.exports=n},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e,n){var r=function(t){"use strict";var e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n,r){var i=e&&e.prototype instanceof l?e:l,o=Object.create(i.prototype),a=new P(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return _()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=x(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=c(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(t,n,a),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=s;var u={};function l(){}function f(){}function p(){}var h={};h[i]=function(){return this};var d=Object.getPrototypeOf,g=d&&d(d(S([])));g&&g!==e&&n.call(g,i)&&(h=g);var v=p.prototype=l.prototype=Object.create(h);function y(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function m(t){var e;this._invoke=function(r,i){function o(){return new Promise((function(e,o){!function e(r,i,o,a){var s=c(t[r],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==typeof l&&n.call(l,"__await")?Promise.resolve(l.__await).then((function(t){e("next",t,o,a)}),(function(t){e("throw",t,o,a)})):Promise.resolve(l).then((function(t){u.value=t,o(u)}),(function(t){return e("throw",t,o,a)}))}a(s.arg)}(r,i,e,o)}))}return e=e?e.then(o,o):o()}}function x(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,x(t,e),"throw"===e.method))return u;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,u;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,u):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,u)}function b(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function w(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(b,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:_}}function _(){return{value:void 0,done:!0}}return f.prototype=v.constructor=p,p.constructor=f,p[a]=f.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,a in t||(t[a]="GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},y(m.prototype),m.prototype[o]=function(){return this},t.AsyncIterator=m,t.async=function(e,n,r,i){var o=new m(s(e,n,r,i));return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},y(v),v[a]="Generator",v[i]=function(){return this},v.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=S,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),u},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),w(n),u}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;w(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},t}(t.exports);try{regeneratorRuntime=r}catch(t){Function("r","regeneratorRuntime = r")(r)}},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(t,e,n){"use strict";n.r(e);var r=n(4),i=n.n(r),o=n(5),a=n.n(o),s=n(3),c=n.n(s),u=n(7),l=n.n(u),f=n(8),p=n.n(f),h=n(1),d=n.n(h),g=n(2),v=n(6);function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var m=[0,0,0,255],x={getSourcePosition:{type:"accessor",value:function(t){return t.sourcePosition}},getTargetPosition:{type:"accessor",value:function(t){return t.targetPosition}},getSourceColor:{type:"accessor",value:m},getTargetColor:{type:"accessor",value:m},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}},b=function(t){l()(n,t);var e=y(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getShaders",value:function(){return c()(d()(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME arc-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\nattribute float instanceHeights;\nattribute float instanceTilts;\n\nuniform bool greatCircle;\nuniform bool useShortestPath;\nuniform float numSegments;\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nfloat paraboloid(float distance, float sourceZ, float targetZ, float ratio) {\n\n  float deltaZ = targetZ - sourceZ;\n  float dh = distance * instanceHeights;\n  float unitZ = dh == 0.0 ? 0.0 : deltaZ / dh;\n  float p2 = unitZ * unitZ + 1.0;\n  float dir = step(deltaZ, 0.0);\n  float z0 = mix(sourceZ, targetZ, dir);\n  float r = mix(ratio, 1.0 - ratio, dir);\n  return sqrt(r * (p2 - r)) * dh + z0;\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\n\nvec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {\n  float distance = length(source.xy - target.xy);\n  float z = paraboloid(distance, source.z, target.z, segmentRatio);\n\n  float tiltAngle = radians(instanceTilts);\n  vec2 tiltDirection = normalize(target.xy - source.xy);\n  vec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);\n\n  return vec3(\n    mix(source.xy, target.xy, segmentRatio) + tilt,\n    z * cos(tiltAngle)\n  );\n}\nfloat getAngularDist (vec2 source, vec2 target) {\n  vec2 sourceRadians = radians(source);\n  vec2 targetRadians = radians(target);\n  vec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);\n  vec2 shd_sq = sin_half_delta * sin_half_delta;\n\n  float a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;\n  return 2.0 * asin(sqrt(a));\n}\n\nvec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {\n  vec2 lngLat;\n  if(abs(angularDist - PI) < 0.001) {\n    lngLat = (1.0 - t) * source.xy + t * target.xy;\n  } else {\n    float a = sin((1.0 - t) * angularDist);\n    float b = sin(t * angularDist);\n    vec3 p = source3D.yxz * a + target3D.yxz * b;\n    lngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));\n  }\n\n  float z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);\n\n  return vec3(lngLat, z);\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));\n  float nextSegmentRatio = getSegmentRatio(min(numSegments - 1.0, segmentIndex + 1.0));\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  isValid = 1.0;\n\n  uv = vec2(segmentRatio, positions.y);\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n\n  vec4 curr;\n  vec4 next;\n  vec3 source;\n  vec3 target;\n\n  if ((greatCircle || project_uProjectionMode == PROJECTION_MODE_GLOBE) && project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    source = project_globe_(vec3(instanceSourcePositions.xy, 0.0));\n    target = project_globe_(vec3(instanceTargetPositions.xy, 0.0));\n    float angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);\n\n    vec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);\n    vec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);\n    vec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);\n\n    if (abs(currPos.x - prevPos.x) > 180.0) {\n      indexDir = -1.0;\n      isValid = 0.0;\n    } else if (abs(currPos.x - nextPos.x) > 180.0) {\n      indexDir = 1.0;\n      isValid = 0.0;\n    }\n    nextPos = indexDir < 0.0 ? prevPos : nextPos;\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n\n    if (isValid == 0.0) {\n      nextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;\n      float t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);\n      currPos = mix(currPos, nextPos, t);\n      segmentRatio = mix(segmentRatio, nextSegmentRatio, t);\n    }\n\n    vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);\n    vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);\n  \n    curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);\n    next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));\n  \n  } else {\n    vec3 source_world = instanceSourcePositions;\n    vec3 target_world = instanceTargetPositions;\n    if (useShortestPath) {\n      source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n      target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n\n      float deltaLng = target_world.x - source_world.x;\n      if (deltaLng > 180.) target_world.x -= 360.;\n      if (deltaLng < -180.) source_world.x -= 360.;\n    }\n    source = project_position(source_world, instanceSourcePositions64Low);\n    target = project_position(target_world, instanceTargetPositions64Low);\n\n    if (useShortestPath) {\n      float thresholdRatio = -source.x / (target.x - source.x);\n\n      if (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {\n        isValid = 0.0;\n        indexDir = sign(segmentRatio - thresholdRatio);\n        segmentRatio = thresholdRatio;\n      }\n    }\n\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n    vec3 currPos = interpolateFlat(source, target, segmentRatio);\n    vec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);\n\n    if (useShortestPath) {\n      if (nextPos.x < 0.0) {\n        currPos.x += TILE_SIZE;\n        nextPos.x += TILE_SIZE;\n      }\n    }\n\n    curr = project_common_position_to_clipspace(vec4(currPos, 1.0));\n    next = project_common_position_to_clipspace(vec4(nextPos, 1.0));\n    geometry.position = vec4(currPos, 1.0);\n  }\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale),\n    widthMinPixels, widthMaxPixels\n  );\n  vec3 offset = vec3(\n    getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);\n  vColor = vec4(color.rgb, color.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME arc-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nvoid main(void) {\n  if (isValid == 0.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  geometry.uv = uv;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[g.project32,g.picking]})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getSourceColor",defaultValue:m},instanceTargetColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getTargetColor",defaultValue:m},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}},{key:"updateState",value:function(t){var e=t.props,r=t.oldProps,i=t.changeFlags;if(c()(d()(n.prototype),"updateState",this).call(this,{props:e,oldProps:r,changeFlags:i}),i.extensionsChanged){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.context.viewport,r=this.props,i=r.widthUnits,o=r.widthScale,a=r.widthMinPixels,s=r.widthMaxPixels,c=r.greatCircle,u=r.wrapLongitude,l="pixels"===i?n.metersPerPixel:1;this.state.model.setUniforms(e).setUniforms({greatCircle:c,widthScale:o*l,widthMinPixels:a,widthMaxPixels:s,useShortestPath:u}).draw()}},{key:"_getModel",value:function(t){for(var e=[],n=0;n<50;n++)e=e.concat([n,1,0,n,-1,0]);var r=new v.Model(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new v.Geometry({drawMode:5,attributes:{positions:new Float32Array(e)}}),isInstanced:!0}));return r.setUniforms({numSegments:50}),r}},{key:"wrapLongitude",get:function(){return!1}}]),n}(g.Layer);b.layerName="ArcLayer",b.defaultProps=x;var w=n(10),P=n.n(w);function S(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var C=n(12),O=n(11),L="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var M,k;M=new L(4),L!=Float32Array&&(M[0]=0,M[1]=0,M[2]=0,M[3]=0),k=M;function A(t,e){var n=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}([],e,t);return function(t,e,n){t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n}(n,n,1/n[3]),n}function j(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],c=e[5],u=e[6],l=e[7],f=e[8],p=e[9],h=e[10],d=e[11],g=e[12],v=e[13],y=e[14],m=e[15],x=n[0],b=n[1],w=n[2],P=n[3];return t[0]=x*r+b*s+w*f+P*g,t[1]=x*i+b*c+w*p+P*v,t[2]=x*o+b*u+w*h+P*y,t[3]=x*a+b*l+w*d+P*m,x=n[4],b=n[5],w=n[6],P=n[7],t[4]=x*r+b*s+w*f+P*g,t[5]=x*i+b*c+w*p+P*v,t[6]=x*o+b*u+w*h+P*y,t[7]=x*a+b*l+w*d+P*m,x=n[8],b=n[9],w=n[10],P=n[11],t[8]=x*r+b*s+w*f+P*g,t[9]=x*i+b*c+w*p+P*v,t[10]=x*o+b*u+w*h+P*y,t[11]=x*a+b*l+w*d+P*m,x=n[12],b=n[13],w=n[14],P=n[15],t[12]=x*r+b*s+w*f+P*g,t[13]=x*i+b*c+w*p+P*v,t[14]=x*o+b*u+w*h+P*y,t[15]=x*a+b*l+w*d+P*m,t}function E(t,e,n){var r,i,o,a,s,c,u,l,f,p,h,d,g=n[0],v=n[1],y=n[2];return e===t?(t[12]=e[0]*g+e[4]*v+e[8]*y+e[12],t[13]=e[1]*g+e[5]*v+e[9]*y+e[13],t[14]=e[2]*g+e[6]*v+e[10]*y+e[14],t[15]=e[3]*g+e[7]*v+e[11]*y+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],c=e[5],u=e[6],l=e[7],f=e[8],p=e[9],h=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=c,t[6]=u,t[7]=l,t[8]=f,t[9]=p,t[10]=h,t[11]=d,t[12]=r*g+s*v+f*y+e[12],t[13]=i*g+c*v+p*y+e[13],t[14]=o*g+u*v+h*y+e[14],t[15]=a*g+l*v+d*y+e[15]),t}function I(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function R(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],c=t[6],u=t[7],l=t[8],f=t[9],p=t[10],h=t[11],d=t[12],g=t[13],v=t[14],y=t[15],m=e[0],x=e[1],b=e[2],w=e[3],P=e[4],S=e[5],_=e[6],C=e[7],O=e[8],L=e[9],M=e[10],k=e[11],A=e[12],j=e[13],E=e[14],I=e[15];return Math.abs(n-m)<=1e-6*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(r-x)<=1e-6*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(i-b)<=1e-6*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(o-w)<=1e-6*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(a-P)<=1e-6*Math.max(1,Math.abs(a),Math.abs(P))&&Math.abs(s-S)<=1e-6*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(c-_)<=1e-6*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(u-C)<=1e-6*Math.max(1,Math.abs(u),Math.abs(C))&&Math.abs(l-O)<=1e-6*Math.max(1,Math.abs(l),Math.abs(O))&&Math.abs(f-L)<=1e-6*Math.max(1,Math.abs(f),Math.abs(L))&&Math.abs(p-M)<=1e-6*Math.max(1,Math.abs(p),Math.abs(M))&&Math.abs(h-k)<=1e-6*Math.max(1,Math.abs(h),Math.abs(k))&&Math.abs(d-A)<=1e-6*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(g-j)<=1e-6*Math.max(1,Math.abs(g),Math.abs(j))&&Math.abs(v-E)<=1e-6*Math.max(1,Math.abs(v),Math.abs(E))&&Math.abs(y-I)<=1e-6*Math.max(1,Math.abs(y),Math.abs(I))}function T(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function z(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}!function(){var t=function(){var t=new L(2);return L!=Float32Array&&(t[0]=0,t[1]=0),t}()}();!function(){var t=function(){var t=new L(3);return L!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}()}();function F(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}var D=Math.PI,N=D/4,W=D/180,U=180/D;function G(t){return Math.pow(2,t)}function B(t){var e=_(t,2),n=e[0],r=e[1];F(Number.isFinite(n)),F(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude");var i=r*W;return[512*(n*W+D)/(2*D),512*(D+Math.log(Math.tan(N+.5*i)))/(2*D)]}function V(t){var e=_(t,2),n=e[0],r=e[1],i=n/512*(2*D)-D,o=2*(Math.atan(Math.exp(r/512*(2*D)-D))-N);return[i*U,o*U]}function Z(t){var e=t.latitude,n=t.longitude,r=t.highPrecision,i=void 0!==r&&r;F(Number.isFinite(e)&&Number.isFinite(n));var o={},a=Math.cos(e*W),s=512/360/a,c=512/4003e4/a;if(o.unitsPerMeter=[c,c,c],o.metersPerUnit=[1/c,1/c,1/c],o.unitsPerDegree=[512/360,s,c],o.degreesPerUnit=[.703125,1/s,1/c],i){var u=W*Math.tan(e*W)/a,l=512/360*u/2,f=512/4003e4*u,p=f/s*c;o.unitsPerDegree2=[0,l,f],o.unitsPerMeter2=[p,0,p]}return o}function H(t){var e=t.height,n=t.pitch,r=t.bearing,i=t.altitude,o=t.scale,a=t.center,s=void 0===a?null:a,c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return E(c,c,[0,0,-i]),function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],c=e[7],u=e[8],l=e[9],f=e[10],p=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+u*r,t[5]=a*i+l*r,t[6]=s*i+f*r,t[7]=c*i+p*r,t[8]=u*i-o*r,t[9]=l*i-a*r,t[10]=f*i-s*r,t[11]=p*i-c*r}(c,c,-n*W),function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],c=e[3],u=e[4],l=e[5],f=e[6],p=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+u*r,t[1]=a*i+l*r,t[2]=s*i+f*r,t[3]=c*i+p*r,t[4]=u*i-o*r,t[5]=l*i-a*r,t[6]=f*i-s*r,t[7]=p*i-c*r}(c,c,r*W),I(c,c,[o/=e,o,o]),s&&E(c,c,function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}([],s)),c}function K(t){var e=t.width,n=t.height,r=t.pitch,i=function(t){var e=t.width,n=t.height,r=t.altitude,i=void 0===r?1.5:r,o=t.pitch,a=void 0===o?0:o,s=t.nearZMultiplier,c=void 0===s?1:s,u=t.farZMultiplier,l=void 0===u?1:u,f=a*W,p=Math.atan(.5/i),h=Math.sin(p)*i/Math.sin(Math.min(Math.max(Math.PI/2-f-p,.01),Math.PI-.01));return{fov:2*p,aspect:e/n,focalDistance:i,near:c,far:(Math.sin(f)*h+i)*l}}({width:e,height:n,altitude:t.altitude,pitch:r,nearZMultiplier:t.nearZMultiplier,farZMultiplier:t.farZMultiplier});return function(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}([],i.fov,i.aspect,i.near,i.far)}function J(t,e){var n=_(t,3),r=n[0],i=n[1],o=n[2],a=void 0===o?0:o;return F(Number.isFinite(r)&&Number.isFinite(i)&&Number.isFinite(a)),A(e,[r,i,a,1])}function q(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=_(t,3),i=r[0],o=r[1],a=r[2];if(F(Number.isFinite(i)&&Number.isFinite(o),"invalid pixel coordinate"),Number.isFinite(a)){var s=A(e,[i,o,a,1]);return s}var c=A(e,[i,o,0,1]),u=A(e,[i,o,1,1]),l=c[2],f=u[2],p=l===f?0:((n||0)-l)/(f-l);return z([],c,u,p)}function X(t){var e=t.width,n=t.height,r=t.bounds,i=t.minExtent,o=void 0===i?0:i,a=t.maxZoom,s=void 0===a?24:a,c=t.padding,u=void 0===c?0:c,l=t.offset,f=void 0===l?[0,0]:l,p=_(r,2),h=_(p[0],2),d=h[0],g=h[1],v=_(p[1],2),y=v[0],m=v[1];if(Number.isFinite(u)){u={top:u,bottom:u,left:u,right:u}}else F(Number.isFinite(u.top)&&Number.isFinite(u.bottom)&&Number.isFinite(u.left)&&Number.isFinite(u.right));var x=new tt({width:e,height:n,longitude:0,latitude:0,zoom:0}),b=x.project([d,m]),w=x.project([y,g]),P=[Math.max(Math.abs(w[0]-b[0]),o),Math.max(Math.abs(w[1]-b[1]),o)],S=[e-u.left-u.right-2*Math.abs(f[0]),n-u.top-u.bottom-2*Math.abs(f[1])];F(S[0]>0&&S[1]>0);var C=S[0]/P[0],O=S[1]/P[1],L=(u.right-u.left)/2/C,M=(u.bottom-u.top)/2/O,k=[(w[0]+b[0])/2+L,(w[1]+b[1])/2+M],A=x.unproject(k),j=Math.min(s,x.zoom+Math.log2(Math.abs(Math.min(C,O))));return F(Number.isFinite(j)),{longitude:A[0],latitude:A[1],zoom:j}}var Y=Math.PI/180;function $(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=t.width,o=t.height,a=t.unproject,s={targetZ:r},c=a([0,o],s),u=a([i,o],s),l=Math.atan(.5/t.altitude),f=(90-t.pitch)*Y;return l>f-.01?(e=Q(t,0,r),n=Q(t,i,r)):(e=a([0,0],s),n=a([i,0],s)),[c,u,n,e]}function Q(t,e,n){var r=t.pixelUnprojectionMatrix,i=A(r,[e,0,1,1]),o=A(r,[e,t.height,1,1]),a=V(z([],i,o,(n*t.distanceScales.unitsPerMeter[2]-i[2])/(o[2]-i[2])));return a[2]=n,a}var tt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{width:1,height:1},n=e.width,r=e.height,i=e.latitude,o=void 0===i?0:i,a=e.longitude,s=void 0===a?0:a,c=e.zoom,u=void 0===c?0:c,l=e.pitch,f=void 0===l?0:l,p=e.bearing,h=void 0===p?0:p,d=e.altitude,g=void 0===d?1.5:d,v=e.nearZMultiplier,y=void 0===v?.02:v,m=e.farZMultiplier,x=void 0===m?1.01:m;Object(C.a)(this,t),n=n||1,r=r||1;var b=G(u);g=Math.max(.75,g);var w=B([s,o]);w[2]=0,this.projectionMatrix=K({width:n,height:r,pitch:f,altitude:g,nearZMultiplier:y,farZMultiplier:x}),this.viewMatrix=H({height:r,scale:b,center:w,pitch:f,bearing:h,altitude:g}),this.width=n,this.height=r,this.scale=b,this.latitude=o,this.longitude=s,this.zoom=u,this.pitch=f,this.bearing=h,this.altitude=g,this.center=w,this.distanceScales=Z(this),this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}return Object(O.a)(t,[{key:"_initMatrices",value:function(){var t=this.width,e=this.height,n=this.projectionMatrix,r=this.viewMatrix,i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];j(i,i,n),j(i,i,r),this.viewProjectionMatrix=i;var o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];I(o,o,[t/2,-e/2,1]),E(o,o,[1,-1,0]),j(o,o,i);var a=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],c=e[6],u=e[7],l=e[8],f=e[9],p=e[10],h=e[11],d=e[12],g=e[13],v=e[14],y=e[15],m=n*s-r*a,x=n*c-i*a,b=n*u-o*a,w=r*c-i*s,P=r*u-o*s,S=i*u-o*c,_=l*g-f*d,C=l*v-p*d,O=l*y-h*d,L=f*v-p*g,M=f*y-h*g,k=p*y-h*v,A=m*k-x*M+b*L+w*O-P*C+S*_;return A?(A=1/A,t[0]=(s*k-c*M+u*L)*A,t[1]=(i*M-r*k-o*L)*A,t[2]=(g*S-v*P+y*w)*A,t[3]=(p*P-f*S-h*w)*A,t[4]=(c*O-a*k-u*C)*A,t[5]=(n*k-i*O+o*C)*A,t[6]=(v*b-d*S-y*x)*A,t[7]=(l*S-p*b+h*x)*A,t[8]=(a*M-s*O+u*_)*A,t[9]=(r*O-n*M-o*_)*A,t[10]=(d*P-g*b+y*m)*A,t[11]=(f*b-l*P-h*m)*A,t[12]=(s*C-a*L-c*_)*A,t[13]=(n*L-r*C+i*_)*A,t[14]=(g*x-d*w-v*m)*A,t[15]=(l*w-f*x+p*m)*A,t):null}([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o);if(!a)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=o,this.pixelUnprojectionMatrix=a}},{key:"equals",value:function(e){return e instanceof t&&(e.width===this.width&&e.height===this.height&&R(e.projectionMatrix,this.projectionMatrix)&&R(e.viewMatrix,this.viewMatrix))}},{key:"project",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=this.projectPosition(t),o=J(i,this.pixelProjectionMatrix),a=_(o,2),s=a[0],c=a[1],u=r?c:this.height-c;return 2===t.length?[s,u]:[s,u,o[2]]}},{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=e.targetZ,o=void 0===i?void 0:i,a=_(t,3),s=a[0],c=a[1],u=a[2],l=r?c:this.height-c,f=o&&o*this.distanceScales.unitsPerMeter[2],p=q([s,l,u],this.pixelUnprojectionMatrix,f),h=this.unprojectPosition(p),d=_(h,3),g=d[0],v=d[1],y=d[2];return Number.isFinite(u)?[g,v,y]:Number.isFinite(o)?[g,v,o]:[g,v]}},{key:"projectPosition",value:function(t){var e=_(B(t),2);return[e[0],e[1],(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}},{key:"unprojectPosition",value:function(t){var e=_(V(t),2);return[e[0],e[1],(t[2]||0)*this.distanceScales.metersPerUnit[2]]}},{key:"projectFlat",value:function(t){return B(t)}},{key:"unprojectFlat",value:function(t){return V(t)}},{key:"getMapCenterByLngLatPosition",value:function(t){var e=t.lngLat,n=q(t.pos,this.pixelUnprojectionMatrix),r=T([],B(e),function(t,e){return t[0]=-e[0],t[1]=-e[1],t}([],n));return V(T([],this.center,r))}},{key:"getLocationAtPoint",value:function(t){var e=t.lngLat,n=t.pos;return this.getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"fitBounds",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.width,i=this.height,o=X(Object.assign({width:r,height:i,bounds:e},n)),a=o.longitude,s=o.latitude,c=o.zoom;return new t({width:r,height:i,longitude:a,latitude:s,zoom:c})}},{key:"getBounds",value:function(t){var e=this.getBoundingRegion(t),n=Math.min.apply(Math,S(e.map((function(t){return t[0]})))),r=Math.max.apply(Math,S(e.map((function(t){return t[0]}))));return[[n,Math.min.apply(Math,S(e.map((function(t){return t[1]}))))],[r,Math.max.apply(Math,S(e.map((function(t){return t[1]}))))]]}},{key:"getBoundingRegion",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return $(this,t.z||0)}}]),t}();var et=n(9);n(15);Math.PI,Math.PI;var nt={};function rt(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function it(t,e,n){return rt(t)?t.map((function(t,r){return it(t,e[r],n)})):n*e+(1-n)*t}nt.EPSILON=1e-12,nt.debug=!1,nt.precision=4,nt.printTypes=!1,nt.printDegrees=!1,nt.printRowMajor=!0;var ot={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global};(ot.global||ot.self||ot.window).mathgl={config:nt};var at=new Uint16Array([0,2,1,0,3,2]),st=new Float32Array([0,1,0,0,1,0,1,1]);function ct(t,e){if(!e)return function(t){for(var e=new Float64Array(12),n=0;n<t.length;n++)e[3*n+0]=t[n][0],e[3*n+1]=t[n][1],e[3*n+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:at,texCoords:st}}(t);for(var n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),r=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),i=Math.ceil(n/e)+1,o=Math.ceil(r/e)+1,a=(i-1)*(o-1)*6,s=new Uint32Array(a),c=new Float32Array(i*o*2),u=new Float64Array(i*o*3),l=0,f=0,p=0;p<i;p++)for(var h=p/(i-1),d=0;d<o;d++){var g=d/(o-1),v=ut(t,h,g);u[3*l+0]=v[0],u[3*l+1]=v[1],u[3*l+2]=v[2]||0,c[2*l+0]=h,c[2*l+1]=1-g,p>0&&d>0&&(s[f++]=l-o,s[f++]=l-o-1,s[f++]=l-1,s[f++]=l-o,s[f++]=l-1,s[f++]=l),l++}return{vertexCount:a,positions:u,indices:s,texCoords:c}}function ut(t,e,n){return it(it(t[0],t[1],n),it(t[3],t[2],n),e)}function lt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ft(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var pt={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:g.COORDINATE_SYSTEM.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]}},ht=function(t){l()(n,t);var e=ft(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getShaders",value:function(){return c()(d()(n.prototype),"getShaders",this).call(this,{vs:"\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nattribute vec2 texCoords;\nattribute vec3 positions;\nattribute vec3 positions64Low;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float coordinateConversion;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  if (coordinateConversion < -0.5) {\n    vTexPos = geometry.position.xy;\n  } else if (coordinateConversion > 0.5) {\n    vTexPos = geometry.worldPosition.xy;\n  }\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",fs:"\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float desaturate;\nuniform vec4 transparentColor;\nuniform vec3 tintColor;\nuniform float opacity;\n\nuniform float coordinateConversion;\nuniform vec4 bounds;\n\n/* projection utils */\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / PI / 2.0;\n\n// from degrees to Web Mercator\nvec2 lnglat_to_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// from Web Mercator to degrees\nvec2 mercator_to_lnglat(vec2 xy) {\n  xy /= WORLD_SCALE;\n  return degrees(vec2(\n    xy.x - PI,\n    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5\n  ));\n}\n/* End projection utils */\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  return mix(transparentColor, vec4(color, 1.0), alpha);\n}\n\nvec2 getUV(vec2 pos) {\n  return vec2(\n    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),\n    (pos.y - bounds[3]) / (bounds[1] - bounds[3])\n  );\n}\n\nvoid main(void) {\n  vec2 uv = vTexCoord;\n  if (coordinateConversion < -0.5) {\n    vec2 lnglat = mercator_to_lnglat(vTexPos);\n    uv = getUV(lnglat);\n  } else if (coordinateConversion > 0.5) {\n    vec2 commonPos = lnglat_to_mercator(vTexPos);\n    uv = getUV(commonPos);\n  }\n  vec4 bitmapColor = texture2D(bitmapTexture, uv);\n\n  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);\n\n  geometry.uv = uv;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[g.project32,g.picking]})}},{key:"initializeState",value:function(){var t=this,e=this.getAttributeManager();e.remove(["instancePickingColors"]);e.add({indices:{size:1,isIndexed:!0,update:function(e){return e.value=t.state.mesh.indices},noAlloc:!0},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:function(e){return e.value=t.state.mesh.positions},noAlloc:!0},texCoords:{size:2,update:function(e){return e.value=t.state.mesh.texCoords},noAlloc:!0}})}},{key:"updateState",value:function(t){var e=t.props,n=t.oldProps;if(t.changeFlags.extensionsChanged){var r=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(r)}),this.getAttributeManager().invalidateAll()}var i=this.getAttributeManager();if(e.bounds!==n.bounds){var o=this.state.mesh,a=this._createMesh();for(var s in this.state.model.setVertexCount(a.vertexCount),a)o&&o[s]!==a[s]&&i.invalidate(s);this.setState(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?lt(Object(n),!0).forEach((function(e){P()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({mesh:a},this._getCoordinateUniforms()))}else e._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}},{key:"_createMesh",value:function(){var t=this.props.bounds,e=t;return Number.isFinite(t[0])&&(e=[[t[0],t[1]],[t[0],t[3]],[t[2],t[3]],[t[2],t[1]]]),ct(e,this.context.viewport.resolution)}},{key:"_getModel",value:function(t){return t?new v.Model(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new v.Geometry({drawMode:4,vertexCount:6}),isInstanced:!1})):null}},{key:"draw",value:function(t){var e=t.uniforms,n=this.state,r=n.model,i=n.coordinateConversion,o=n.bounds,a=this.props,s=a.image,c=a.desaturate,u=a.transparentColor,l=a.tintColor;s&&r&&r.setUniforms(e).setUniforms({bitmapTexture:s,desaturate:c,transparentColor:u.map((function(t){return t/255})),tintColor:l.slice(0,3).map((function(t){return t/255})),coordinateConversion:i,bounds:o}).draw()}},{key:"_getCoordinateUniforms",value:function(){var t=g.COORDINATE_SYSTEM.LNGLAT,e=g.COORDINATE_SYSTEM.CARTESIAN,n=g.COORDINATE_SYSTEM.DEFAULT,r=this.props._imageCoordinateSystem;if(r!==n){var i=this.props.bounds;if(!Number.isFinite(i[0]))throw new Error("_imageCoordinateSystem only supports rectangular bounds");var o=this.context.viewport.resolution?t:e;if((r=r===t?t:e)===t&&o===e)return{coordinateConversion:-1,bounds:i};if(r===e&&o===t){var a=B([i[0],i[1]]),s=B([i[2],i[3]]);return{coordinateConversion:1,bounds:[a[0],a[1],s[0],s[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}]),n}(g.Layer);ht.layerName="BitmapLayer",ht.defaultProps=pt;var dt=n(0),gt=n.n(dt);function vt(t,e,n,r,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function yt(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){vt(o,r,i,a,s,"next",t)}function s(t){vt(o,r,i,a,s,"throw",t)}a(void 0)}))}}function mt(t,e){if(!t)throw new Error(e)}var xt={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},bt=xt.global||xt.self||xt.window,wt="object"!==("undefined"==typeof process?"undefined":Object(et.a)(process))||"[object process]"!==String(process)||process.browser,Pt="undefined"!=typeof process&&process.version&&process.version.match(/v([0-9]*)/),St=(Pt&&parseFloat(Pt[1]),bt._parseImageNode),_t="undefined"!=typeof Image,Ct="undefined"!=typeof ImageBitmap,Ot=Boolean(St),Lt=!!wt||Ot;function Mt(t){var e=At(t);if(!e)throw new Error("Not an image");return e}function kt(t){switch(Mt(t)){case"data":return t;case"image":case"imagebitmap":var e=document.createElement("canvas"),n=e.getContext("2d");if(n)return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:return mt(!1)}}function At(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&t instanceof Image?"image":t&&"object"===Object(et.a)(t)&&t.data&&t.width&&t.height?"data":null}var jt=/^data:image\/svg\+xml/,Et=/\.svg((\?|#).*)?$/;function It(t){return t&&(jt.test(t)||Et.test(t))}function Rt(t,e){if(It(e)){var n=(new TextDecoder).decode(t);return"data:image/svg+xml;base64,".concat(btoa(n))}return Tt(t,e)}function Tt(t,e){if(It(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}function zt(t,e,n){return Ft.apply(this,arguments)}function Ft(){return(Ft=yt(gt.a.mark((function t(e,n,r){var i,o,a;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=Rt(e,r),o=self.URL||self.webkitURL,a="string"!=typeof i&&o.createObjectURL(i),t.prev=3,t.next=6,Dt(a||i,n);case 6:return t.abrupt("return",t.sent);case 7:return t.prev=7,a&&o.revokeObjectURL(a),t.finish(7);case 10:case"end":return t.stop()}}),t,null,[[3,,7,10]])})))).apply(this,arguments)}function Dt(t,e){return Nt.apply(this,arguments)}function Nt(){return(Nt=yt(gt.a.mark((function t(e,n){var r;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((r=new Image).src=e,!(n.image&&n.image.decode&&r.decode)){t.next=6;break}return t.next=5,r.decode();case 5:return t.abrupt("return",r);case 6:return t.next=8,new Promise((function(t,n){try{r.onload=function(){return t(r)},r.onerror=function(t){return n(new Error("Could not load image ".concat(e,": ").concat(t)))}}catch(t){n(t)}}));case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Wt={},Ut=!0;function Gt(t,e,n){return Bt.apply(this,arguments)}function Bt(){return(Bt=yt(gt.a.mark((function t(e,n,r){var i,o,a;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!It(r)){t.next=7;break}return t.next=3,zt(e,n,r);case 3:o=t.sent,i=o,t.next=8;break;case 7:i=Tt(e,r);case 8:return a=n&&n.imagebitmap,t.next=11,Vt(i,a);case 11:return t.abrupt("return",t.sent);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Vt(t){return Zt.apply(this,arguments)}function Zt(){return(Zt=yt(gt.a.mark((function t(e){var n,r=arguments;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Ht(n=r.length>1&&void 0!==r[1]?r[1]:null)&&Ut||(n=null),!n){t.next=13;break}return t.prev=3,t.next=6,createImageBitmap(e,n);case 6:return t.abrupt("return",t.sent);case 9:t.prev=9,t.t0=t.catch(3),console.warn(t.t0),Ut=!1;case 13:return t.next=15,createImageBitmap(e);case 15:return t.abrupt("return",t.sent);case 16:case"end":return t.stop()}}),t,null,[[3,9]])})))).apply(this,arguments)}function Ht(t){for(var e in t||Wt)return!1;return!0}function Kt(t){var e=Jt(t);return function(t){var e=Jt(t);if(!(e.byteLength>=24&&2303741511===e.getUint32(0,!1)))return null;return{mimeType:"image/png",width:e.getUint32(16,!1),height:e.getUint32(20,!1)}}(e)||function(t){var e=Jt(t);if(!(e.byteLength>=3&&65496===e.getUint16(0,!1)&&255===e.getUint8(2)))return null;var n=function(){for(var t=new Set([65499,65476,65484,65501,65534]),e=65504;e<65520;++e)t.add(e);var n=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:t,sofMarkers:n}}(),r=n.tableMarkers,i=n.sofMarkers,o=2;for(;o+9<e.byteLength;){var a=e.getUint16(o,!1);if(i.has(a))return{mimeType:"image/jpeg",height:e.getUint16(o+5,!1),width:e.getUint16(o+7,!1)};if(!r.has(a))return null;o+=2,o+=e.getUint16(o,!1)}return null}(e)||function(t){var e=Jt(t);if(!(e.byteLength>=10&&1195984440===e.getUint32(0,!1)))return null;return{mimeType:"image/gif",width:e.getUint16(6,!0),height:e.getUint16(8,!0)}}(e)||function(t){var e=Jt(t);if(!(e.byteLength>=14&&16973===e.getUint16(0,!1)&&e.getUint32(2,!0)===e.byteLength))return null;return{mimeType:"image/bmp",width:e.getUint32(18,!0),height:e.getUint32(22,!0)}}(e)}function Jt(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}function qt(t,e){var n=(Kt(t)||{}).mimeType,r=bt._parseImageNode;return mt(r),r(t,n,e)}function Xt(){return(Xt=yt(gt.a.mark((function t(e,n,r){var i,o,a,s,c;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=(n=n||{}).image||{},o=i.type||"auto",a=(r||{}).url,s=Yt(o),t.t0=s,t.next="imagebitmap"===t.t0?8:"image"===t.t0?12:"data"===t.t0?16:20;break;case 8:return t.next=10,Gt(e,n,a);case 10:return c=t.sent,t.abrupt("break",21);case 12:return t.next=14,zt(e,n,a);case 14:return c=t.sent,t.abrupt("break",21);case 16:return t.next=18,qt(e,n);case 18:return c=t.sent,t.abrupt("break",21);case 20:mt(!1);case 21:return"data"===o&&(c=kt(c)),t.abrupt("return",c);case 23:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Yt(t){switch(t){case"auto":case"data":return function(){if(Ct)return"imagebitmap";if(_t)return"image";if(Lt)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(t){switch(t){case"auto":return Ct||_t||Lt;case"imagebitmap":return Ct;case"image":return _t;case"data":return Lt;case"html":return _t;case"ndarray":return Lt;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}(t),t}}var $t={id:"image",name:"Images",version:"2.3.0",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function(t,e,n){return Xt.apply(this,arguments)},tests:[function(t){return Boolean(Kt(new DataView(t)))}],options:{image:{type:"auto",decode:!0}}},Qt=function(t){return"boolean"==typeof t},te=function(t){return"function"==typeof t},ee=function(t){return null!==t&&"object"===Object(et.a)(t)},ne=function(t){return ee(t)&&t.constructor==={}.constructor},re=function(t){return t&&"function"==typeof t[Symbol.iterator]},ie=function(t){return t&&"function"==typeof t[Symbol.asyncIterator]},oe=function(t){return"undefined"!=typeof Response&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json},ae=function(t){return"undefined"!=typeof Blob&&t instanceof Blob},se=function(t){return function(t){return"undefined"!=typeof ReadableStream&&t instanceof ReadableStream||ee(t)&&te(t.tee)&&te(t.cancel)&&te(t.getReader)}(t)||function(t){return ee(t)&&te(t.read)&&te(t.pipe)&&Qt(t.readable)}(t)};function ce(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ue(t,e){if(!t)throw new Error(e||"loader assertion failed.")}function le(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function fe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?le(Object(n),!0).forEach((function(e){ce(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function pe(t){if(!t)return!1;Array.isArray(t)&&(t=t[0]);var e=t.parseTextSync||t.parseSync||t.parse||t.parseStream||t.parseInBatches,n=t.options&&t.options[t.id];return e=e||n&&n.workerUrl}function he(t){var e;return ue(t,"null loader"),ue(pe(t),"invalid loader"),Array.isArray(t)&&(e=t[1],t=fe(fe({},t=t[0]),{},{options:fe(fe({},t.options),e)})),t.extension&&(t.extensions=t.extensions||t.extension,delete t.extension),Array.isArray(t.extensions)||(t.extensions=[t.extensions]),ue(t.extensions&&t.extensions.length>0&&t.extensions[0]),(t.parseTextSync||t.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}var de={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},ge=de.global||de.self||de.window,ve="object"!==("undefined"==typeof process?"undefined":Object(et.a)(process))||"[object process]"!==String(process)||process.browser,ye="undefined"!=typeof process&&process.version&&process.version.match(/v([0-9]*)/),me=ye&&parseFloat(ye[1])||0,xe="",be={};function we(t){for(var e in be)if(t.startsWith(e)){var n=be[e];t=t.replace(e,n)}return t.startsWith("http://")||t.startsWith("https://")||(t="".concat(xe).concat(t)),t}var Pe=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Se=/^([-\w.]+\/[-\w.+]+)/;function _e(t){if("string"!=typeof t)return"";var e=t.match(Pe);return e?e[1]:""}var Ce=/\?.*/;function Oe(t){if(oe(t)){var e=function(t){if("string"!=typeof t)return"";var e=t.match(Se);return e?e[1]:t}(t.headers.get("content-type")),n=_e(t.url);return{url:Me(t.url||""),type:e||n||null}}return ae(t)?{url:Me(t.name||""),type:t.type||""}:"string"==typeof t?{url:Me(t),type:_e(t)}:{url:"",type:""}}function Le(t){return oe(t)?t.headers["content-length"]||-1:ae(t)?t.size:"string"==typeof t?t.length:t instanceof ArrayBuffer?t.byteLength:ArrayBuffer.isView(t)?t.byteLength:-1}function Me(t){return t.replace(Ce,"")}function ke(t){return Ae.apply(this,arguments)}function Ae(){return(Ae=yt(gt.a.mark((function t(e){var n,r,i,o,a,s,c;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!oe(e)){t.next=2;break}return t.abrupt("return",e);case 2:return n={},(r=Le(e))>=0&&(n["content-length"]=String(r)),i=Oe(e),o=i.url,(a=i.type)&&(n["content-type"]=a),t.next=9,Te(e);case 9:return(s=t.sent)&&(n["x-first-bytes"]=s),"string"==typeof e&&(e=(new TextEncoder).encode(e)),c=new Response(e,{headers:n}),Object.defineProperty(c,"url",{value:o}),t.abrupt("return",c);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function je(t){return Ee.apply(this,arguments)}function Ee(){return(Ee=yt(gt.a.mark((function t(e){var n;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ok){t.next=5;break}return t.next=3,Ie(e);case 3:throw n=t.sent,new Error(n);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ie(t){return Re.apply(this,arguments)}function Re(){return(Re=yt(gt.a.mark((function t(e){var n,r,i;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="Failed to fetch resource ".concat(e.url," (").concat(e.status,"): "),t.prev=1,r=e.headers.get("Content-Type"),i=e.statusText,!r.includes("application/json")){t.next=11;break}return t.t0=i,t.t1=" ",t.next=9,e.text();case 9:t.t2=t.sent,i=t.t0+=t.t1.concat.call(t.t1,t.t2);case 11:n=(n+=i).length>60?"".concat(n.slice(60),"..."):n,t.next=17;break;case 15:t.prev=15,t.t3=t.catch(1);case 17:return t.abrupt("return",n);case 18:case"end":return t.stop()}}),t,null,[[1,15]])})))).apply(this,arguments)}function Te(t){return ze.apply(this,arguments)}function ze(){return(ze=yt(gt.a.mark((function t(e){var n,r,i,o;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=5,"string"!=typeof e){t.next=3;break}return t.abrupt("return","data:,".concat(e.slice(0,n)));case 3:if(!(e instanceof Blob)){t.next=8;break}return r=e.slice(0,5),t.next=7,new Promise((function(t){var e=new FileReader;e.onload=function(e){return t(e.target&&e.target.result)},e.readAsDataURL(r)}));case 7:return t.abrupt("return",t.sent);case 8:if(!(e instanceof ArrayBuffer)){t.next=12;break}return i=e.slice(0,n),o=Fe(i),t.abrupt("return","data:base64,".concat(o));case 12:return t.abrupt("return",null);case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Fe(t){for(var e="",n=new Uint8Array(t),r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}function De(t){return Ne.apply(this,arguments)}function Ne(){return(Ne=yt(gt.a.mark((function t(e){var n;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="Failed to fetch resource ".concat(e.url," (").concat(e.status,"): "),t.prev=1,!e.headers.get("Content-Type").includes("application/json")){t.next=10;break}return t.t0=n,t.next=7,e.text();case 7:n=t.t0+=t.sent,t.next=11;break;case 10:n+=e.statusText;case 11:t.next=16;break;case 13:return t.prev=13,t.t1=t.catch(1),t.abrupt("return",n);case 16:return t.abrupt("return",n);case 17:case"end":return t.stop()}}),t,null,[[1,13]])})))).apply(this,arguments)}function We(t){return Ue.apply(this,arguments)}function Ue(){return(Ue=yt(gt.a.mark((function t(e){var n,r,i=arguments;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:{},"string"==typeof e){t.next=5;break}return t.next=4,ke(e);case 4:return t.abrupt("return",t.sent);case 5:return e=we(e),t.next=8,fetch(e,n);case 8:if((r=t.sent).ok||!n.throws){t.next=15;break}return t.t0=Error,t.next=13,De(r);case 13:throw t.t1=t.sent,new t.t0(t.t1);case 15:return t.abrupt("return",r);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Ge=function(){function t(){Object(C.a)(this,t)}return Object(O.a)(t,[{key:"log",value:function(){return function(t){}}},{key:"info",value:function(){return function(t){}}},{key:"warn",value:function(){return function(t){}}},{key:"error",value:function(){return function(t){}}}]),t}();function Be(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ve(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ve(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ve(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ze(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function He(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ze(Object(n),!0).forEach((function(e){ce(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ke={fetch:null,CDN:"https://unpkg.com/@loaders.gl",worker:!0,log:new(function(){function t(){Object(C.a)(this,t),this.console=console}return Object(O.a)(t,[{key:"log",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=this.console.log).bind.apply(t,[this.console].concat(n))}},{key:"info",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=this.console.info).bind.apply(t,[this.console].concat(n))}},{key:"warn",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=this.console.warn).bind.apply(t,[this.console].concat(n))}},{key:"error",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=this.console.error).bind.apply(t,[this.console].concat(n))}}]),t}()),metadata:!1,transforms:[]},Je={dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"},qe=function(){ge.loaders=ge.loaders||{};var t=ge.loaders;return t._state=t._state||{},t._state},Xe=function(){var t=qe();return t.globalOptions=t.globalOptions||He({},Ke),t.globalOptions};function Ye(t,e,n,r){return n=n||[],function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console;Qe(t,null,n,Ke,Je,e);var r,i=Be(e);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=t&&t[o.id]||{},s=o.options&&o.options[o.id]||{},c=o.defaultOptions&&o.defaultOptions[o.id]||{};Qe(a,o.id,n,s,c,e)}}catch(t){i.e(t)}finally{i.f()}}(t,n=Array.isArray(n)?n:[n]),en(e,t,r)}function $e(t,e){var n=Xe(),r=t.fetch||n.fetch;return"function"==typeof r?r:ee(r)?function(t){return We(t,r)}:e&&e.fetch?e.fetch:function(e){return We(e,t)}}function Qe(t,e,n,r,i,o){var a=e||"Top level",s=e?"".concat(e,"."):"";for(var c in t){var u=!e&&ee(t[c]);if(!(c in r))if(c in i)n.warn("".concat(a," loader option '").concat(s).concat(c,"' deprecated, use '").concat(i[c],"'"));else if(!u){var l=tn(c,o);n.warn("".concat(a," loader option '").concat(s).concat(c,"' not recognized. ").concat(l))}}}function tn(t,e){var n,r=t.toLowerCase(),i="",o=Be(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;for(var s in a.options){if(t===s)return"Did you mean '".concat(a.id,".").concat(s,"'?");var c=s.toLowerCase();(r.startsWith(c)||c.startsWith(r))&&(i=i||"Did you mean '".concat(a.id,".").concat(s,"'?"))}}}catch(t){o.e(t)}finally{o.f()}return i}function en(t,e,n){var r=He({},t.options||{});return function(t,e){!e||"baseUri"in t||(t.baseUri=e)}(r,n),null===r.log&&(r.log=new Ge),nn(r,Xe()),nn(r,e),r}function nn(t,e){for(var n in e)if(n in e){var r=e[n];ne(r)&&ne(t[n])?t[n]=He(He({},t[n]),e[n]):t[n]=e[n]}}function rn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"2.3.0";ue(t,"no loader provided");var n=t.version;e&&n&&(e=on(e),n=on(n))}function on(t){var e=t.split(".").map(Number);return{major:e[0],minor:e[1]}}function an(t){var e;if("undefined"!=typeof Symbol){if(Symbol.asyncIterator&&null!=(e=t[Symbol.asyncIterator]))return e.call(t);if(Symbol.iterator&&null!=(e=t[Symbol.iterator]))return e.call(t)}throw new TypeError("Object is not async iterable")}var sn=n(14);function cn(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return un(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return un(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function un(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ln(t){if(sn.toArrayBuffer&&(t=sn.toArrayBuffer(t)),t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.buffer;if("string"==typeof t){var e=t;return(new TextEncoder).encode(e).buffer}return t&&"object"===Object(et.a)(t)&&t._toArrayBuffer?t._toArrayBuffer():ue(!1)}function fn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,i=e.map((function(t){return t instanceof ArrayBuffer?new Uint8Array(t):t})),o=i.reduce((function(t,e){return t+e.byteLength}),0),a=new Uint8Array(o),s=0,c=cn(i);try{for(c.s();!(r=c.n()).done;){var u=r.value;a.set(u,s),s+=u.byteLength}}catch(t){c.e(t)}finally{c.f()}return a.buffer}function pn(t){return hn.apply(this,arguments)}function hn(){return(hn=yt(gt.a.mark((function t(e){var n,r,i,o,a,s,c,u,l;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],r=[],i=!0,o=!1,t.prev=4,s=an(e);case 6:return t.next=8,s.next();case 8:return c=t.sent,i=c.done,t.next=12,c.value;case 12:if(u=t.sent,i){t.next=19;break}"string"==typeof(l=u)?r.push(l):n.push(l);case 16:i=!0,t.next=6;break;case 19:t.next=25;break;case 21:t.prev=21,t.t0=t.catch(4),o=!0,a=t.t0;case 25:if(t.prev=25,t.prev=26,i||null==s.return){t.next=30;break}return t.next=30,s.return();case 30:if(t.prev=30,!o){t.next=33;break}throw a;case 33:return t.finish(30);case 34:return t.finish(25);case 35:if(!(r.length>0)){t.next=38;break}return ue(0===n.length),t.abrupt("return",r.join(""));case 38:return t.abrupt("return",fn.apply(void 0,n));case 39:case"end":return t.stop()}}),t,null,[[4,21,25,35],[26,,30,34]])})))).apply(this,arguments)}var dn=gt.a.mark(gn);function gn(t){var e,n,r,i,o,a,s,c=arguments;return gt.a.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:e=c.length>1&&void 0!==c[1]?c[1]:{},n=e.chunkSize,r=void 0===n?262144:n,i=0,o=new TextEncoder;case 4:if(!(i<t.length)){u.next=12;break}return a=Math.min(t.length-i,r),s=t.slice(i,i+a),i+=a,u.next=10,o.encode(s);case 10:u.next=4;break;case 12:case"end":return u.stop()}}),dn)}var vn=gt.a.mark(yn);function yn(t){var e,n,r,i,o,a,s,c=arguments;return gt.a.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:e=c.length>1&&void 0!==c[1]?c[1]:{},n=e.chunkSize,r=void 0===n?262144:n,i=0;case 3:if(!(i<t.byteLength)){u.next=14;break}return o=Math.min(t.byteLength-i,r),a=new ArrayBuffer(o),s=new Uint8Array(t,i,o),new Uint8Array(a).set(s),i+=o,u.next=12,a;case 12:u.next=3;break;case 14:case"end":return u.stop()}}),vn)}function mn(t){this.wrapped=t}function xn(t){return new mn(t)}function bn(t){var e,n;function r(e,n){try{var o=t[e](n),a=o.value,s=a instanceof mn;Promise.resolve(s?a.wrapped:a).then((function(t){s?r("return"===e?"return":"next",t):i(o.done?"return":"normal",t)}),(function(t){r("throw",t)}))}catch(t){i("throw",t)}}function i(t,i){switch(t){case"return":e.resolve({value:i,done:!0});break;case"throw":e.reject(i);break;default:e.resolve({value:i,done:!1})}(e=e.next)?r(e.key,e.arg):n=null}this._invoke=function(t,i){return new Promise((function(o,a){var s={key:t,arg:i,resolve:o,reject:a,next:null};n?n=n.next=s:(e=n=s,r(t,i))}))},"function"!=typeof t.return&&(this.return=void 0)}function wn(t){return function(){return new bn(t.apply(this,arguments))}}"function"==typeof Symbol&&Symbol.asyncIterator&&(bn.prototype[Symbol.asyncIterator]=function(){return this}),bn.prototype.next=function(t){return this._invoke("next",t)},bn.prototype.throw=function(t){return this._invoke("throw",t)},bn.prototype.return=function(t){return this._invoke("return",t)};function Pn(t){return Sn.apply(this,arguments)}function Sn(){return(Sn=wn(gt.a.mark((function t(e){var n,r,i,o,a,s=arguments;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=s.length>1&&void 0!==s[1]?s[1]:{},r=n.chunkSize||1048576,i=0;case 3:if(!(i<e.size)){t.next=13;break}return o=i+r,t.next=7,xn(_n(e,i,o));case 7:return a=t.sent,i=o,t.next=11,a;case 11:t.next=3;break;case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _n(t,e,n){return Cn.apply(this,arguments)}function Cn(){return(Cn=yt(gt.a.mark((function t(e,n,r){return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t,i){var o=e.slice(n,r),a=new FileReader;a.onload=function(e){return t(e.target&&e.target.result)},a.onerror=function(t){return i(t)},a.readAsArrayBuffer(o)}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function On(t){if(ve||me>=10){if("function"==typeof t[Symbol.asyncIterator])return function(t){return Ln.apply(this,arguments)}(t);if("function"==typeof t.getIterator)return t.getIterator()}return ve?function(t){return Mn.apply(this,arguments)}(t):function(t){return kn.apply(this,arguments)}(t)}function Ln(){return(Ln=wn(gt.a.mark((function t(e){var n,r,i,o,a,s,c;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!0,r=!1,t.prev=2,o=an(e);case 4:return t.next=6,xn(o.next());case 6:return a=t.sent,n=a.done,t.next=10,xn(a.value);case 10:if(s=t.sent,n){t.next=18;break}return c=s,t.next=15,ln(c);case 15:n=!0,t.next=4;break;case 18:t.next=24;break;case 20:t.prev=20,t.t0=t.catch(2),r=!0,i=t.t0;case 24:if(t.prev=24,t.prev=25,n||null==o.return){t.next=29;break}return t.next=29,xn(o.return());case 29:if(t.prev=29,!r){t.next=32;break}throw i;case 32:return t.finish(29);case 33:return t.finish(24);case 34:case"end":return t.stop()}}),t,null,[[2,20,24,34],[25,,29,33]])})))).apply(this,arguments)}function Mn(){return(Mn=wn(gt.a.mark((function t(e){var n,r,i,o;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.getReader(),t.prev=1;case 2:return t.next=5,xn(n.read());case 5:if(r=t.sent,i=r.done,o=r.value,!i){t.next=10;break}return t.abrupt("return");case 10:return t.next=12,ln(o);case 12:t.next=2;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(1),n.releaseLock();case 19:case"end":return t.stop()}}),t,null,[[1,16]])})))).apply(this,arguments)}function kn(){return(kn=wn(gt.a.mark((function t(e){var n;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,xn(e);case 2:e=t.sent;case 3:if(null===(n=e.read())){t.next=9;break}return t.next=8,ln(n);case 8:return t.abrupt("continue",3);case 9:if(!e._readableState.ended){t.next=11;break}return t.abrupt("return");case 11:return t.next=13,xn(An(e));case 13:t.next=3;break;case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function An(t){return jn.apply(this,arguments)}function jn(){return(jn=yt(gt.a.mark((function t(e){return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){e.once("readable",t)})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function En(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof t?gn(t,e):t instanceof ArrayBuffer?yn(t,e):ae(t)?Pn(t,e):se(t)?On(t):oe(t)?On(t.body):ue(!1)}var In="Cannot convert supplied data type";function Rn(t,e){if(e.text&&"string"==typeof t)return t;if(t instanceof ArrayBuffer){var n=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(t)||(o=t)&&"object"===Object(et.a)(o)&&o.isBuffer){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);var r=t.buffer,i=t.byteLength||t.length;return 0===t.byteOffset&&i===r.byteLength||(r=r.slice(t.byteOffset,t.byteOffset+i)),r}var o;throw new Error(In)}function Tn(t,e){return zn.apply(this,arguments)}function zn(){return(zn=yt(gt.a.mark((function t(e,n){var r,i;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e instanceof ArrayBuffer||ArrayBuffer.isView(e),"string"!=typeof e&&!r){t.next=3;break}return t.abrupt("return",Rn(e,n));case 3:if(!ae(e)){t.next=7;break}return t.next=6,ke(e);case 6:e=t.sent;case 7:if(!oe(e)){t.next=21;break}return i=e,t.next=11,je(i);case 11:if(!n.binary){t.next=17;break}return t.next=14,i.arrayBuffer();case 14:t.t0=t.sent,t.next=20;break;case 17:return t.next=19,i.text();case 19:t.t0=t.sent;case 20:return t.abrupt("return",t.t0);case 21:if(se(e)&&(e=En(e)),!re(e)&&!ie(e)){t.next=24;break}return t.abrupt("return",pn(e));case 24:throw new Error(In);case 25:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Fn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Dn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Fn(Object(n),!0).forEach((function(e){ce(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Fn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Nn(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n||(t=Dn({fetch:$e(e||{},t)},t),Array.isArray(t.loaders)||(t.loaders=null),t)}function Wn(t,e){if(!e&&t&&!Array.isArray(t))return t;var n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){var r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[].concat(S(n),S(r)):r}return n&&n.length?n:null}var Un=new Map;function Gn(t){return"try {\n  importScripts('".concat(t,"');\n} catch (error) {\n  console.error(error);\n}")}function Bn(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=n||new Set;if(t){if(Vn(t))r.add(t);else if(Vn(t.buffer))r.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"===Object(et.a)(t))for(var i in t)Bn(t[i],e,r)}else;return void 0===n?Array.from(r):[]}function Vn(t){return!!t&&(t instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&t instanceof MessagePort||("undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)))}var Zn=0;function Hn(t){var e=t.data;(0,t.resolve)(e)}var Kn=function(){function t(e){var n=e.source,r=e.name,i=void 0===r?"web-worker-".concat(Zn++):r,o=e.onMessage;Object(C.a)(this,t);var a=function(t){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1],ue("string"==typeof t,"worker source"),t.startsWith("url(")&&t.endsWith(")")){var e=t.match(/^url\((.*)\)$/)[1];if(e&&!e.startsWith("http"))return e;t=Gn(e)}var n=Un.get(t);if(!n){var r=new Blob([t],{type:"application/javascript"});n=URL.createObjectURL(r),Un.set(t,n)}return n}(n,i);this.worker=new Worker(a,{name:i}),this.name=i,this.onMessage=o||Hn}var e;return Object(O.a)(t,[{key:"process",value:(e=yt(gt.a.mark((function t(e){var n=this;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){n.worker.onmessage=function(e){n.onMessage({worker:n.worker,data:e.data,resolve:t,reject:r})},n.worker.onerror=function(t){var e="".concat(n.name,": WorkerThread.process() failed");t.message&&(e+=" ".concat(t.message," ").concat(t.filename,":").concat(t.lineno,":").concat(t.colno));var i=new Error(e);console.error(t),r(i)};var i=Bn(e);n.worker.postMessage(e,i)})));case 1:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})},{key:"destroy",value:function(){this.worker.terminate(),this.worker=null}}]),t}(),Jn=function(){function t(e){var n=e.source,r=e.name,i=void 0===r?"unnamed":r,o=e.maxConcurrency,a=void 0===o?1:o,s=e.onMessage,c=e.onDebug,u=void 0===c?function(){}:c;Object(C.a)(this,t),this.source=n,this.name=i,this.maxConcurrency=a,this.onMessage=s,this.onDebug=u,this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1}var e;return Object(O.a)(t,[{key:"destroy",value:function(){this.idleQueue.forEach((function(t){return t.destroy()})),this.isDestroyed=!0}},{key:"process",value:function(t,e){var n=this;return new Promise((function(r,i){n.jobQueue.push({data:t,jobName:e,resolve:r,reject:i}),n._startQueuedJob()}))}},{key:"_startQueuedJob",value:(e=yt(gt.a.mark((function t(){var e,n;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.jobQueue.length){t.next=2;break}return t.abrupt("return");case 2:if(e=this._getAvailableWorker()){t.next=5;break}return t.abrupt("return");case 5:return n=this.jobQueue.shift(),this.onDebug({message:"processing",worker:e.name,job:n.jobName,backlog:this.jobQueue.length}),t.prev=7,t.t0=n,t.next=11,e.process(n.data);case 11:t.t1=t.sent,t.t0.resolve.call(t.t0,t.t1),t.next=18;break;case 15:t.prev=15,t.t2=t.catch(7),n.reject(t.t2);case 18:return t.prev=18,this._onWorkerDone(e),t.finish(18);case 21:case"end":return t.stop()}}),t,this,[[7,15,18,21]])}))),function(){return e.apply(this,arguments)})},{key:"_onWorkerDone",value:function(t){this.isDestroyed?t.destroy():(this.idleQueue.push(t),this._startQueuedJob())}},{key:"_getAvailableWorker",value:function(){if(this.idleQueue.length>0)return this.idleQueue.shift();if(this.count<this.maxConcurrency){this.count++;var t="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Kn({source:this.source,onMessage:this.onMessage,name:t})}return null}}]),t}(),qn=function(){function t(e){var n=e.maxConcurrency,r=void 0===n?5:n,i=e.onMessage,o=void 0===i?null:i,a=e.onDebug,s=void 0===a?function(){}:a;Object(C.a)(this,t),this.maxConcurrency=r,this.onMessage=o,this.onDebug=s,this.workerPools=new Map}var e;return Object(O.a)(t,null,[{key:"isSupported",value:function(){return"undefined"!=typeof Worker}}]),Object(O.a)(t,[{key:"setProps",value:function(t){"maxConcurrency"in t&&(this.maxConcurrency=t.maxConcurrency),"onDebug"in t&&(this.onDebug=t.onDebug)}},{key:"destroy",value:function(){this.workerPools.forEach((function(t){return t.destroy()}))}},{key:"process",value:(e=yt(gt.a.mark((function t(e,n,r){var i;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this._getWorkerPool(e,n),t.abrupt("return",i.process(r));case 2:case"end":return t.stop()}}),t,this)}))),function(t,n,r){return e.apply(this,arguments)})},{key:"_getWorkerPool",value:function(t,e){var n=this.workerPools.get(e);return n||(n=new Jn({source:t,name:e,onMessage:Xn.bind(null,this.onMessage),maxConcurrency:this.maxConcurrency,onDebug:this.onDebug}),this.workerPools.set(e,n)),n}}]),t}();function Xn(t,e){var n=e.worker,r=e.data,i=e.resolve,o=e.reject;if(t)t({worker:n,data:r,resolve:i,reject:o});else switch(r.type){case"done":i(r.result);break;case"error":o(r.message)}}function Yn(t,e,n,r){if(!qn.isSupported())return!1;var i=n&&n[t.id];return!!("local"===n.worker&&i&&i.localWorkerUrl||n.worker&&i&&i.workerUrl)&&(!t.useWorker||t.useWorker(n))}function $n(t,e,n,r){var i=(n||{}).worker,o=n&&n[t.id]||{},a="local"===i?o.localWorkerUrl:o.workerUrl,s="url(".concat(a,")"),c=t.name,u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={};t.maxConcurrency&&(e.maxConcurrency=t.maxConcurrency);t.onDebug&&(e.onDebug=t.onDebug);Qn||(Qn=new qn({onMessage:tr}));return Qn.setProps(e),Qn}(n);n=JSON.parse(JSON.stringify(n));var l="2.3.0"!==t.version?"(core version ".concat("2.3.0",")"):"";return u.process(s,"".concat(c,"-worker@").concat(t.version).concat(l),{arraybuffer:ln(e),options:n,source:"loaders.gl@".concat("2.3.0"),type:"parse"})}var Qn=null;function tr(t){return er.apply(this,arguments)}function er(){return(er=yt(gt.a.mark((function t(e){var n,r,i,o,a;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.worker,r=e.data,i=e.resolve,o=e.reject,t.t0=r.type,t.next="done"===t.t0?4:"parse"===t.t0?6:"error"===t.t0?17:19;break;case 4:return i(r.result),t.abrupt("break",19);case 6:return t.prev=6,t.next=9,wr(r.arraybuffer,r.options,r.url);case 9:a=t.sent,n.postMessage({type:"parse-done",id:r.id,result:a},Bn(a)),t.next=16;break;case 13:t.prev=13,t.t1=t.catch(6),n.postMessage({type:"parse-error",id:r.id,message:t.t1.message});case 16:return t.abrupt("break",19);case 17:return o(r.message),t.abrupt("break",19);case 19:case"end":return t.stop()}}),t,null,[[6,13]])})))).apply(this,arguments)}var nr=function(){var t=qe();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function rr(){return nr()}function ir(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function or(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ir(Object(n),!0).forEach((function(e){ce(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ir(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ar(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return sr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sr(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function sr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var cr,ur=/\.([^.]+)$/;function lr(t){return fr.apply(this,arguments)}function fr(){return(fr=yt(gt.a.mark((function t(e){var n,r,i,o,a=arguments;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:[],r=a.length>2&&void 0!==a[2]?a[2]:{},i=a.length>3&&void 0!==a[3]?a[3]:{},!(o=pr(e,n,or(or({},r),{},{nothrow:!0}),i))){t.next=6;break}return t.abrupt("return",o);case 6:if(!ae(e)){t.next=11;break}return t.next=9,_n(e,0,10);case 9:e=t.sent,o=pr(e,n,r,i);case 11:if(o||r.nothrow){t.next=13;break}throw new Error(hr(e));case 13:return t.abrupt("return",o);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function pr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e&&!Array.isArray(e))return he(e);dr(e=[].concat(S(e||[]),S(rr())));var i=Oe(t),o=i.url,a=i.type,s=gr(e,o||r.url);if(!(s=(s=s||vr(e,a))||yr(e,t))&&!n.nothrow)throw new Error(hr(t));return s}function hr(t){var e=Oe(t),n=e.url,r=e.type,i="No valid loader found";return t&&(i+=' data: "'.concat(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"==typeof t)return t.slice(0,e);if(ArrayBuffer.isView(t))return br(t.buffer,t.byteOffset,e);if(t instanceof ArrayBuffer){var n=0;return br(t,n,e)}return""}(t),'", contentType: "').concat(r,'"')),n&&(i+=" url: ".concat(n)),i}function dr(t){var e,n=ar(t);try{for(n.s();!(e=n.n()).done;){he(e.value)}}catch(t){n.e(t)}finally{n.f()}}function gr(t,e){var n=e&&e.match(ur),r=n&&n[1];return r&&function(t,e){e=e.toLowerCase();var n,r=ar(t);try{for(r.s();!(n=r.n()).done;){var i,o=n.value,a=ar(o.extensions);try{for(a.s();!(i=a.n()).done;){if(i.value.toLowerCase()===e)return o}}catch(t){a.e(t)}finally{a.f()}}}catch(t){r.e(t)}finally{r.f()}return null}(t,r)}function vr(t,e){var n,r=ar(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.mimeTypes&&i.mimeTypes.includes(e))return i;if(e==="application/x.".concat(i.id))return i}}catch(t){r.e(t)}finally{r.f()}return null}function yr(t,e){if(!e)return null;var n,r=ar(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if("string"==typeof e){if(mr(e,i))return i}else if(ArrayBuffer.isView(e)){if(xr(e.buffer,e.byteOffset,i))return i}else if(e instanceof ArrayBuffer){if(xr(e,0,i))return i}}}catch(t){r.e(t)}finally{r.f()}return null}function mr(t,e){return e.testText&&e.testText(t)}function xr(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((function(r){return function(t,e,n,r){if(r instanceof ArrayBuffer)return function(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;for(var r=new Uint8Array(t),i=new Uint8Array(e),o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(r,t,r.byteLength);switch(Object(et.a)(r)){case"function":return r(t,n);case"string":var i=br(t,e,r.length);return r===i;default:return!1}}(t,e,n,r)}))}function br(t,e,n){if(t.byteLength<e+n)return"";for(var r=new DataView(t),i="",o=0;o<n;o++)i+=String.fromCharCode(r.getUint8(e+o));return i}function wr(t,e,n,r){return Pr.apply(this,arguments)}function Pr(){return(Pr=yt(gt.a.mark((function t(e,n,r,i){var o,a,s,c;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ue(!i||"string"!=typeof i,"parse no longer accepts final url"),!n||Array.isArray(n)||pe(n)||(i=r,r=n,n=null),t.next=4,e;case 4:return e=t.sent,r=r||{},o=Oe(e),a=o.url,s=Wn(n,i),t.next=10,lr(e,s,r);case 10:if(c=t.sent){t.next=13;break}return t.abrupt("return",null);case 13:return r=Ye(r,c,s,a),i=Nn({url:a,parse:wr,loaders:s},r,i),t.next=17,Sr(c,e,r,i);case 17:return t.abrupt("return",t.sent);case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Sr(t,e,n,r){return _r.apply(this,arguments)}function _r(){return(_r=yt(gt.a.mark((function t(e,n,r,i){return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return rn(e),t.next=3,Tn(n,e);case 3:if(n=t.sent,!e.parseTextSync||"string"!=typeof n){t.next=7;break}return r.dataType="text",t.abrupt("return",e.parseTextSync(n,r,i,e));case 7:if(!Yn(e,0,r)){t.next=11;break}return t.next=10,$n(e,n,r);case 10:return t.abrupt("return",t.sent);case 11:if(!e.parseText||"string"!=typeof n){t.next=15;break}return t.next=14,e.parseText(n,r,i,e);case 14:return t.abrupt("return",t.sent);case 15:if(!e.parse){t.next=19;break}return t.next=18,e.parse(n,r,i,e);case 18:return t.abrupt("return",t.sent);case 19:return ue(!e.parseSync),t.abrupt("return",ue(!1));case 21:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Cr(){return(Cr=yt(gt.a.mark((function t(e,n,r){var i,o;return gt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Array.isArray(n)||pe(n)||(r=n,n=null),i=$e(r||{}),o=e,"string"!=typeof e){t.next=9;break}return t.next=6,i(e);case 6:o=t.sent,t.next=10;break;case 9:e=null;case 10:if(!ae(e)){t.next=15;break}return t.next=13,i(e);case 13:o=t.sent,e=null;case 15:return t.next=17,wr(o,n,r);case 17:return t.abrupt("return",t.sent);case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Or(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Lr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Or(Object(n),!0).forEach((function(e){P()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Or(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Mr(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return kr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kr(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function kr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Ar=function(){},jr=(cr={},P()(cr,10241,9987),P()(cr,10240,9729),P()(cr,10242,33071),P()(cr,10243,33071),cr);function Er(t){return t&&(t.id||t.url)}function Ir(t,e,n){for(var r=0;r<e.length;r++){var i=e[r],o=i.icon,a=i.xOffset;t[Er(o)]=Object.assign({},o,{x:a,y:n})}}var Rr=function(){function t(e,n){var r=n.onUpdate,o=void 0===r?Ar:r,a=n.onError,s=void 0===a?Ar:a;i()(this,t),this.gl=e,this.onUpdate=o,this.onError=s,this._loadOptions=null,this._getIcon=null,this._texture=null,this._externalTexture=null,this._mapping={},this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=4,this._canvasWidth=1024,this._canvasHeight=0,this._canvas=null}return a()(t,[{key:"finalize",value:function(){this._texture&&this._texture.delete()}},{key:"getTexture",value:function(){return this._texture||this._externalTexture}},{key:"getIconMapping",value:function(t){var e=this._autoPacking?Er(t):t;return this._mapping[e]||{}}},{key:"setProps",value:function(t){var e=t.loadOptions,n=t.autoPacking,r=t.iconAtlas,i=t.iconMapping,o=t.data,a=t.getIcon;e&&(this._loadOptions=e),void 0!==n&&(this._autoPacking=n),a&&(this._getIcon=a),i&&(this._mapping=i),r&&this._updateIconAtlas(r),this._autoPacking&&(o||a)&&"undefined"!=typeof document&&(this._canvas=this._canvas||document.createElement("canvas"),this._updateAutoPacking(o))}},{key:"_updateIconAtlas",value:function(t){this._texture&&(this._texture.delete(),this._texture=null),this._externalTexture=t,this.onUpdate()}},{key:"_updateAutoPacking",value:function(t){var e,n,r,i,o,a,s=Object.values(function(t,e,n){if(!t||!e)return null;n=n||{};var r,i={},o=Object(g.createIterable)(t),a=o.iterable,s=o.objectInfo,c=Mr(a);try{for(c.s();!(r=c.n()).done;){var u=r.value;s.index++;var l=e(u,s),f=Er(l);if(!l)throw new Error("Icon is missing.");if(!l.url)throw new Error("Icon url is missing.");i[f]||n[f]&&l.url===n[f].url||(i[f]=Lr(Lr({},l),{},{source:u,sourceIndex:s.index}))}}catch(t){c.e(t)}finally{c.f()}return i}(t,this._getIcon,this._mapping)||{});if(s.length>0){var c=function(t){for(var e,n=t.icons,r=t.buffer,i=t.mapping,o=void 0===i?{}:i,a=t.xOffset,s=void 0===a?0:a,c=t.yOffset,u=void 0===c?0:c,l=t.rowHeight,f=void 0===l?0:l,p=t.canvasWidth,h=[],d=0;d<n.length;d++){var g=n[d];if(!o[Er(g)]){var v=g.height,y=g.width;s+y+r>p&&(Ir(o,h,u),s=0,u=f+u+r,f=0,h=[]),h.push({icon:g,xOffset:s}),s=s+y+r,f=Math.max(f,v)}}return h.length>0&&Ir(o,h,u),{mapping:o,rowHeight:f,xOffset:s,yOffset:u,canvasWidth:p,canvasHeight:(e=f+u+r,Math.pow(2,Math.ceil(Math.log2(e))))}}({icons:s,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset}),u=c.mapping,l=c.xOffset,f=c.yOffset,p=c.rowHeight,h=c.canvasHeight;this._rowHeight=p,this._mapping=u,this._xOffset=l,this._yOffset=f,this._canvasHeight=h,this._texture||(this._texture=new v.Texture2D(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:jr})),this._texture.height!==this._canvasHeight&&(this._texture=(this.gl,e=this._texture,n=this._canvasWidth,r=this._canvasHeight,i=e.width,o=e.height,a=Object(v.cloneTextureFrom)(e,{width:n,height:r}),Object(v.copyToTexture)(e,a,{targetY:0,width:i,height:o}),e.delete(),a)),this.onUpdate(),this._loadIcons(s)}}},{key:"_loadIcons",value:function(t){var e,n=this,r=this._canvas.getContext("2d"),i=Mr(t);try{var o=function(){var t=e.value;n._pendingCount++,function(t,e,n){return Cr.apply(this,arguments)}(t.url,$t,n._loadOptions).then((function(e){var i=Er(t),o=n._mapping[i],a=o.x,s=o.y,c=o.width,u=o.height,l=function(t,e,n,r){return n===e.width&&r===e.height?e:(t.canvas.height=r,t.canvas.width=n,t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(e,0,0,e.width,e.height,0,0,n,r),t.canvas)}(r,e,c,u);n._texture.setSubImageData({data:l,x:a,y:s,width:c,height:u}),n._texture.generateMipmap(),n.onUpdate()})).catch((function(e){n.onError({url:t.url,source:t.source,sourceIndex:t.sourceIndex,loadOptions:n._loadOptions,error:e})})).finally((function(){n._pendingCount--}))};for(i.s();!(e=i.n()).done;)o()}catch(t){i.e(t)}finally{i.f()}}},{key:"isLoaded",get:function(){return 0===this._pendingCount}}]),t}();function Tr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var zr=[0,0,0,255],Fr={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:function(t){return t.position}},getIcon:{type:"accessor",value:function(t){return t.icon}},getColor:{type:"accessor",value:zr},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}},Dr=function(t){l()(n,t);var e=Tr(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getShaders",value:function(){return c()(d()(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[g.project32,g.picking]})}},{key:"initializeState",value:function(){this.state={iconManager:new Rr(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:zr},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}},{key:"updateState",value:function(t){var e=t.oldProps,r=t.props,i=t.changeFlags;c()(d()(n.prototype),"updateState",this).call(this,{props:r,oldProps:e,changeFlags:i});var o=this.getAttributeManager(),a=r.iconAtlas,s=r.iconMapping,u=r.data,l=r.getIcon,f=this.state.iconManager;f.setProps({loadOptions:r.loadOptions});var p=!1;if(a||this.internalState.isAsyncPropLoading("iconAtlas")?(e.iconAtlas!==r.iconAtlas&&f.setProps({iconAtlas:a,autoPacking:!1}),e.iconMapping!==r.iconMapping&&(f.setProps({iconMapping:s}),p=!0)):f.setProps({autoPacking:!0}),(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&f.setProps({data:u,getIcon:l}),p&&(o.invalidate("instanceOffsets"),o.invalidate("instanceIconFrames"),o.invalidate("instanceColorModes")),i.extensionsChanged){var h=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(h)}),o.invalidateAll()}}},{key:"finalizeState",value:function(){c()(d()(n.prototype),"finalizeState",this).call(this),this.state.iconManager.finalize()}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.sizeScale,i=n.sizeMinPixels,o=n.sizeMaxPixels,a=n.sizeUnits,s=n.billboard,c=n.alphaCutoff,u=this.state.iconManager,l=this.context.viewport,f=u.getTexture();f&&this.state.model.setUniforms(Object.assign({},e,{iconsTexture:f,iconsTextureDim:[f.width,f.height],sizeScale:r*("pixels"===a?l.metersPerPixel:1),sizeMinPixels:i,sizeMaxPixels:o,billboard:s,alphaCutoff:c})).draw()}},{key:"_getModel",value:function(t){return new v.Model(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new v.Geometry({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0}))}},{key:"_onUpdate",value:function(){this.setNeedsRedraw()}},{key:"_onError",value:function(t){var e=this.getCurrentLayer().props.onIconError;e?e(t):g.log.error(t.error)()}},{key:"getInstanceOffset",value:function(t){var e=this.state.iconManager.getIconMapping(t);return[e.width/2-e.anchorX||0,e.height/2-e.anchorY||0]}},{key:"getInstanceColorMode",value:function(t){return this.state.iconManager.getIconMapping(t).mask?1:0}},{key:"getInstanceIconFrame",value:function(t){var e=this.state.iconManager.getIconMapping(t);return[e.x||0,e.y||0,e.width||0,e.height||0]}},{key:"isLoaded",get:function(){return c()(d()(n.prototype),"isLoaded",this)&&this.state.iconManager.isLoaded}}]),n}(g.Layer);Dr.layerName="IconLayer",Dr.defaultProps=Fr;function Nr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Wr={getSourcePosition:{type:"accessor",value:function(t){return t.sourcePosition}},getTargetPosition:{type:"accessor",value:function(t){return t.targetPosition}},getColor:{type:"accessor",value:[0,0,0,255]},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}},Ur=function(t){l()(n,t);var e=Nr(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getShaders",value:function(){return c()(d()(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME line-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float useShortestPath;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nvec3 splitLine(vec3 a, vec3 b, float x) {\n  float t = (x - a.x) / (b.x - a.x);\n  return vec3(x, mix(a.yz, b.yz, t));\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  vec3 source_world = instanceSourcePositions;\n  vec3 target_world = instanceTargetPositions;\n  vec3 source_world_64low = instanceSourcePositions64Low;\n  vec3 target_world_64low = instanceTargetPositions64Low;\n\n  if (useShortestPath > 0.5 || useShortestPath < -0.5) {\n    source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n    target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n    float deltaLng = target_world.x - source_world.x;\n\n    if (deltaLng * useShortestPath > 180.) {\n      source_world.x += 360. * useShortestPath;\n      source_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      source_world_64low = vec3(0.0);\n    } else if (deltaLng * useShortestPath < -180.) {\n      target_world.x += 360. * useShortestPath;\n      target_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      target_world_64low = vec3(0.0);\n    } else if (useShortestPath < 0.) {\n      gl_Position = vec4(0.);\n      return;\n    }\n  }\n  vec4 source_commonspace;\n  vec4 target_commonspace;\n  vec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);\n  vec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale),\n    widthMinPixels, widthMaxPixels\n  );\n  float segmentIndex = positions.x;\n  vec4 p = mix(source, target, segmentIndex);\n  geometry.position = mix(source_commonspace, target_commonspace, segmentIndex);\n  uv = positions.xy;\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n  vec3 offset = vec3(\n    getExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  gl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME line-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[g.project32,g.picking]})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}},{key:"updateState",value:function(t){var e=t.props,r=t.oldProps,i=t.changeFlags;if(c()(d()(n.prototype),"updateState",this).call(this,{props:e,oldProps:r,changeFlags:i}),i.extensionsChanged){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.context.viewport,r=this.props,i=r.widthUnits,o=r.widthScale,a=r.widthMinPixels,s=r.widthMaxPixels,c=r.wrapLongitude,u="pixels"===i?n.metersPerPixel:1;this.state.model.setUniforms(e).setUniforms({widthScale:o*u,widthMinPixels:a,widthMaxPixels:s,useShortestPath:c?1:0}).draw(),c&&this.state.model.setUniforms({useShortestPath:-1}).draw()}},{key:"_getModel",value:function(t){return new v.Model(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new v.Geometry({drawMode:5,attributes:{positions:new Float32Array([0,-1,0,0,1,0,1,-1,0,1,1,0])}}),isInstanced:!0}))}},{key:"wrapLongitude",get:function(){return!1}}]),n}(g.Layer);Ur.layerName="LineLayer",Ur.defaultProps=Wr;function Gr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Br=[0,0,0,255],Vr=[0,0,1],Zr={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:function(t){return t.position}},getNormal:{type:"accessor",value:Vr},getColor:{type:"accessor",value:Br},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};var Hr=function(t){l()(n,t);var e=Gr(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getShaders",value:function(){return c()(d()(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME point-cloud-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceNormals;\nattribute vec4 instanceColors;\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusPixels;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.normal = project_normal(instanceNormals);\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n  vec3 offset = vec3(positions.xy * radiusPixels, 0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);\n  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n  vColor = vec4(lightColor, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME point-cloud-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition);\n\n  if (distToCenter > 1.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[g.project32,g.gouraudLighting,g.picking]})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:Vr},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:Br}})}},{key:"updateState",value:function(t){var e,r,i,o=t.props,a=t.oldProps,s=t.changeFlags;if(c()(d()(n.prototype),"updateState",this).call(this,{props:o,oldProps:a,changeFlags:s}),s.extensionsChanged){var u=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(u)}),this.getAttributeManager().invalidateAll()}s.dataChanged&&(e=o.data,r=e.header,i=e.attributes,r&&i&&(e.length=r.vertexCount,i.POSITION&&(i.instancePositions=i.POSITION),i.NORMAL&&(i.instanceNormals=i.NORMAL),i.COLOR_0&&(i.instanceColors=i.COLOR_0)))}},{key:"draw",value:function(t){var e=t.uniforms,n=this.context.viewport,r=this.props,i=r.pointSize,o="meters"===r.sizeUnits?1/n.metersPerPixel:1;this.state.model.setUniforms(Object.assign({},e,{radiusPixels:i*o})).draw()}},{key:"_getModel",value:function(t){for(var e=[],n=0;n<3;n++){var r=n/3*Math.PI*2;e.push(2*Math.cos(r),2*Math.sin(r),0)}return new v.Model(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new v.Geometry({drawMode:4,attributes:{positions:new Float32Array(e)}}),isInstanced:!0}))}}]),n}(g.Layer);Hr.layerName="PointCloudLayer",Hr.defaultProps=Zr;function Kr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Jr=[0,0,0,255],qr={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,getPosition:{type:"accessor",value:function(t){return t.position}},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:Jr},getLineColor:{type:"accessor",value:Jr},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}},Xr=function(t){l()(n,t);var e=Kr(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getShaders",value:function(){return c()(d()(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius),\n    radiusMinPixels, radiusMaxPixels\n  );\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  vec3 offset = positions * project_pixel_size(outerRadiusPixels);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = smoothedge(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter);\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[g.project32,g.picking]})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}},{key:"updateState",value:function(t){var e=t.props,r=t.oldProps,i=t.changeFlags;if(c()(d()(n.prototype),"updateState",this).call(this,{props:e,oldProps:r,changeFlags:i}),i.extensionsChanged){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.context.viewport,r=this.props,i=r.radiusUnits,o=r.radiusScale,a=r.radiusMinPixels,s=r.radiusMaxPixels,c=r.stroked,u=r.filled,l=r.lineWidthUnits,f=r.lineWidthScale,p=r.lineWidthMinPixels,h=r.lineWidthMaxPixels,d="pixels"===i?n.metersPerPixel:1,g="pixels"===l?n.metersPerPixel:1;this.state.model.setUniforms(e).setUniforms({stroked:c?1:0,filled:u,radiusScale:o*d,radiusMinPixels:a,radiusMaxPixels:s,lineWidthScale:f*g,lineWidthMinPixels:p,lineWidthMaxPixels:h}).draw()}},{key:"_getModel",value:function(t){return new v.Model(t,Object.assign(this.getShaders(),{id:this.props.id,geometry:new v.Geometry({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0}))}}]),n}(g.Layer);function Yr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Yr(Object(n),!0).forEach((function(e){P()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Yr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Qr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}Xr.layerName="ScatterplotLayer",Xr.defaultProps=qr;var ti=function(t){l()(n,t);var e=Qr(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i()(this,n);var r=t.id,o=void 0===r?Object(v.uid)("column-geometry"):r,a=ei(t),s=a.indices,c=a.attributes;return e.call(this,$r($r({},t),{},{id:o,indices:s,attributes:c}))}return n}(v.Geometry);function ei(t){var e=t.radius,n=t.height,r=void 0===n?1:n,i=t.nradial,o=void 0===i?10:i,a=t.vertices;g.log.assert(!a||a.length>=o);for(var s=o+1,c=3*s,u=2*Math.PI/o,l=new Uint16Array(3*o*2),f=new Float32Array(3*c),p=new Float32Array(3*c),h=0,d=0;d<s;d++)for(var v=d*u,y=a&&a[d%o],m=a&&a[(d+1)%o],x=Math.sin(v),b=Math.cos(v),w=0;w<2;w++)f[h+0]=y?y[0]:b*e,f[h+1]=y?y[1]:x*e,f[h+2]=(.5-w)*r,p[h+0]=y?m[0]-y[0]:b,p[h+1]=y?m[1]-y[1]:x,h+=3;for(var P=0;P<s;P++){var S=Math.floor(P/2)*Math.sign(P%2-.5),_=S*u,C=a&&a[(S+o)%o],O=Math.sin(_),L=Math.cos(_);f[h+0]=C?C[0]:L*e,f[h+1]=C?C[1]:O*e,f[h+2]=r/2,p[h+2]=1,h+=3}for(var M=0,k=0;k<o;k++)l[M++]=2*k+0,l[M++]=2*k+2,l[M++]=2*k+0,l[M++]=2*k+1,l[M++]=2*k+1,l[M++]=2*k+3;return{indices:l,attributes:{POSITION:{size:3,value:f},NORMAL:{size:3,value:p}}}}function ni(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var ri=[0,0,0,255],ii={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:function(t){return t.position}},getFillColor:{type:"accessor",value:ri},getLineColor:{type:"accessor",value:ri},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}},oi=function(t){l()(n,t);var e=ni(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getShaders",value:function(){return c()(d()(n.prototype),"getShaders",this).call(this,{vs:"\n#define SHADER_NAME column-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 normals;\n\nattribute vec3 instancePositions;\nattribute float instanceElevations;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute float instanceStrokeWidths;\n\nattribute vec3 instancePickingColors;\nuniform float opacity;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform bool extruded;\nuniform bool isStroke;\nuniform float coverage;\nuniform float elevationScale;\nuniform float edgeDistance;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nvarying vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n\n  vec4 color = isStroke ? instanceLineColors : instanceFillColors;\n  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  float elevation = 0.0;\n  float strokeOffsetRatio = 1.0;\n\n  if (extruded) {\n    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;\n  } else if (isStroke) {\n    float widthPixels = clamp(project_size_to_pixel(instanceStrokeWidths * widthScale),\n      widthMinPixels, widthMaxPixels) / 2.0;\n    strokeOffsetRatio += sign(positions.z) * project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);\n  }\n  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);\n  float dotRadius = radius * coverage * shouldRender;\n\n  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));\n  geometry.pickingColor = instancePickingColors;\n  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);\n  vec3 centroidPosition64Low = instancePositions64Low;\n  vec3 pos = vec3(project_size(rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius, 0.);\n  DECKGL_FILTER_SIZE(pos, geometry);\n\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  if (extruded && !isStroke) {\n    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n    vColor = vec4(lightColor, color.a * opacity);\n  } else {\n    vColor = vec4(color.rgb, color.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME column-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[g.project32,g.gouraudLighting,g.picking]})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:ri},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:ri},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}},{key:"updateState",value:function(t){var e=t.props,r=t.oldProps,i=t.changeFlags;c()(d()(n.prototype),"updateState",this).call(this,{props:e,oldProps:r,changeFlags:i});var o=i.extensionsChanged;if(o){var a=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(a)}),this.getAttributeManager().invalidateAll()}(o||e.diskResolution!==r.diskResolution||e.vertices!==r.vertices)&&this._updateGeometry(e)}},{key:"getGeometry",value:function(t,e){var n=new ti({radius:1,height:2,vertices:e,nradial:t}),r=0;if(e)for(var i=0;i<t;i++){var o=e[i];r+=Math.sqrt(o[0]*o[0]+o[1]*o[1])/t}else r=1;return this.setState({edgeDistance:Math.cos(Math.PI/t)*r}),n}},{key:"_getModel",value:function(t){return new v.Model(t,Object.assign({},this.getShaders(),{id:this.props.id,isInstanced:!0}))}},{key:"_updateGeometry",value:function(t){var e=t.diskResolution,n=t.vertices,r=this.getGeometry(e,n);this.setState({fillVertexCount:r.attributes.POSITION.value.length/3,wireframeVertexCount:r.indices.value.length}),this.state.model.setProps({geometry:r})}},{key:"draw",value:function(t){var e=t.uniforms,n=this.context.viewport,r=this.props,i=r.lineWidthUnits,o=r.lineWidthScale,a=r.lineWidthMinPixels,s=r.lineWidthMaxPixels,c=r.elevationScale,u=r.extruded,l=r.filled,f=r.stroked,p=r.wireframe,h=r.offset,d=r.coverage,g=r.radius,v=r.angle,y=this.state,m=y.model,x=y.fillVertexCount,b=y.wireframeVertexCount,w=y.edgeDistance,P="pixels"===i?n.metersPerPixel:1;m.setUniforms(Object.assign({},e,{radius:g,angle:v/180*Math.PI,offset:h,extruded:u,coverage:d,elevationScale:c,edgeDistance:w,widthScale:o*P,widthMinPixels:a,widthMaxPixels:s})),u&&p&&(m.setProps({isIndexed:!0}),m.setVertexCount(b).setDrawMode(1).setUniforms({isStroke:!0}).draw()),l&&(m.setProps({isIndexed:!1}),m.setVertexCount(x).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!u&&f&&(m.setProps({isIndexed:!1}),m.setVertexCount(2*x/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}]),n}(g.Layer);function ai(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}oi.layerName="ColumnLayer",oi.defaultProps=ii;var si=function(t){l()(n,t);var e=ai(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getGeometry",value:function(t){return new v.CubeGeometry}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.elevationScale,i=n.extruded,o=n.offset,a=n.coverage,s=n.cellSize,c=n.angle;this.state.model.setUniforms(Object.assign({},e,{radius:s/2,angle:c,offset:o,extruded:i,coverage:a,elevationScale:r,edgeDistance:1,isWireframe:!1})).draw()}}]),n}(oi);si.layerName="GridCellLayer",si.defaultProps={cellSize:{type:"number",min:0,value:1e3},offset:{type:"array",min:0,value:[1,1]}};!function(){function t(e){Object(C.a)(this,t),this.points=e,this.isClosed=function t(e,n,r){var i=nt.EPSILON;r&&(nt.EPSILON=r);try{if(e===n)return!0;if(rt(e)&&rt(n)){if(e.length!==n.length)return!1;for(var o=0;o<e.length;++o)if(!t(e[o],n[o]))return!1;return!0}return e&&e.equals?e.equals(n):n&&n.equals?n.equals(e):!(!Number.isFinite(e)||!Number.isFinite(n))&&Math.abs(e-n)<=nt.EPSILON*Math.max(1,Math.abs(e),Math.abs(n))}finally{nt.EPSILON=i}}(this.points[this.points.length-1],this.points[0]),Object.freeze(this)}Object(O.a)(t,[{key:"getSignedArea",value:function(){var t=0;return this.forEachSegment((function(e,n){t+=(e[0]+n[0])*(e[1]-n[1])})),t/2}},{key:"getArea",value:function(){return Math.abs(this.getSignedArea())}},{key:"getWindingDirection",value:function(){return Math.sign(this.getSignedArea())}},{key:"forEachSegment",value:function(t){for(var e=this.points.length,n=0;n<e-1;n++)t(this.points[n],this.points[n+1],n,n+1);this.isClosed||t(this.points[e-1],this.points[0],e-1,0)}}])}();function ci(t,e){var n=e.length,r=t.length;if(r>0){for(var i=!0,o=0;o<n;o++)if(t[r-n+o]!==e[o]){i=!1;break}if(i)return!1}for(var a=0;a<n;a++)t[r+a]=e[a];return!0}function ui(t,e){for(var n=e.length,r=0;r<n;r++)t[r]=e[r]}function li(t,e,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=r+e*n,a=0;a<n;a++)i[a]=t[o+a];return i}function fi(t,e,n,r){var i,o,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(8&n)i=(r[3]-t[1])/(e[1]-t[1]),o=3;else if(4&n)i=(r[1]-t[1])/(e[1]-t[1]),o=1;else if(2&n)i=(r[2]-t[0])/(e[0]-t[0]),o=2;else{if(!(1&n))return null;i=(r[0]-t[0])/(e[0]-t[0]),o=0}for(var s=0;s<t.length;s++)a[s]=(1&o)===s?r[o]:i*(e[s]-t[s])+t[s];return a}function pi(t,e){var n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function hi(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.size,o=void 0===i?2:i,a=r.broken,s=void 0!==a&&a,c=r.gridResolution,u=void 0===c?10:c,l=r.gridOffset,f=void 0===l?[0,0]:l,p=r.startIndex,h=void 0===p?0:p,d=r.endIndex,g=void 0===d?t.length:d,v=(g-h)/o,y=[],m=[y],x=li(t,0,o,h),b=yi(x,u,f,[]),w=[];ci(y,x);for(var P=1;P<v;P++){for(n=pi(e=li(t,P,o,h,e),b);n;){fi(x,e,n,b,w);var S=pi(w,b);S&&(fi(x,w,S,b,w),n=S),ci(y,w),ui(x,w),mi(b,u,n),s&&y.length>o&&(y=[],m.push(y),ci(y,x)),n=pi(e,b)}ci(y,e),ui(x,e)}return s?m:m[0]}function di(t,e){for(var n=0;n<e.length;n++)t.push(e[n]);return t}function gi(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t.length)return[];for(var r=n.size,i=void 0===r?2:r,o=n.gridResolution,a=void 0===o?10:o,s=n.gridOffset,c=void 0===s?[0,0]:s,u=n.edgeTypes,l=void 0!==u&&u,f=[],p=[{pos:t,types:l&&new Array(t.length/i).fill(1),holes:e||[]}],h=[[],[]],d=[];p.length;){var g=p.shift(),v=g.pos,y=g.types,m=g.holes;xi(v,i,m[0]||v.length,h),d=yi(h[0],a,c,d);var x=pi(h[1],d);if(x){var b=vi(v,y,i,0,m[0]||v.length,d,x),w={pos:b[0].pos,types:b[0].types,holes:[]},P={pos:b[1].pos,types:b[1].types,holes:[]};p.push(w,P);for(var S=0;S<m.length;S++)(b=vi(v,y,i,m[S],m[S+1]||v.length,d,x))[0]&&(w.holes.push(w.pos.length),w.pos=di(w.pos,b[0].pos),l&&(w.types=di(w.types,b[0].types))),b[1]&&(P.holes.push(P.pos.length),P.pos=di(P.pos,b[1].pos),l&&(P.types=di(P.types,b[1].types)))}else{var _={positions:v};l&&(_.edgeTypes=y),m.length&&(_.holeIndices=m),f.push(_)}}return f}function vi(t,e,n,r,i,o,a){for(var s,c,u,l=(i-r)/n,f=[],p=[],h=[],d=[],g=[],v=li(t,l-1,n,r),y=Math.sign(8&a?v[1]-o[3]:v[0]-o[2]),m=e&&e[l-1],x=0,b=0,w=0;w<l;w++)s=li(t,w,n,r,s),c=Math.sign(8&a?s[1]-o[3]:s[0]-o[2]),u=e&&e[r/n+w],c&&y&&y!==c&&(fi(v,s,a,o,g),ci(f,g)&&h.push(m),ci(p,g)&&d.push(m)),c<=0?(ci(f,s)&&h.push(u),x-=c):h.length&&(h[h.length-1]=0),c>=0?(ci(p,s)&&d.push(u),b+=c):d.length&&(d[d.length-1]=0),ui(v,s),y=c,m=u;return[x?{pos:f,types:e&&h}:null,b?{pos:p,types:e&&d}:null]}function yi(t,e,n,r){var i=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=o,r[2]=i+e,r[3]=o+e,r}function mi(t,e,n){8&n?(t[1]+=e,t[3]+=e):4&n?(t[1]-=e,t[3]-=e):2&n?(t[0]+=e,t[2]+=e):1&n&&(t[0]-=e,t[2]-=e)}function xi(t,e,n,r){for(var i=1/0,o=-1/0,a=1/0,s=-1/0,c=0;c<n;c+=e){var u=t[c],l=t[c+1];i=u<i?u:i,o=u>o?u:o,a=l<a?l:a,s=l>s?l:s}return r[0][0]=i,r[0][1]=a,r[1][0]=o,r[1][1]=s,r}function bi(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return wi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wi(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function wi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Pi(t,e,n,r){for(var i=-1,o=-1,a=n+1;a<r;a+=e){var s=Math.abs(t[a]);s>i&&(i=s,o=a-1)}return o}function Si(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:85.051129,o=t[n],a=t[r-e];if(Math.abs(o-a)>180){var s=li(t,0,e,n);s[0]+=360*Math.round((a-o)/360),ci(t,s),s[1]=Math.sign(s[1])*i,ci(t,s),s[0]=o,ci(t,s)}}function _i(t,e,n,r){for(var i,o=t[0],a=n;a<r;a+=e){var s=(i=t[a])-o;(s>180||s<-180)&&(i-=360*Math.round(s/360)),t[a]=o=i}}function Ci(t,e){for(var n,r=t.length/e,i=0;i<r&&((n=t[i*e])+180)%360==0;i++);var o=360*-Math.round(n/360);if(0!==o)for(var a=0;a<r;a++)t[a*e]+=o}function Oi(t,e,n,r){var i=t;if(Array.isArray(t[0])){var o=t.length*e;i=new Array(o);for(var a=0;a<t.length;a++)for(var s=0;s<e;s++)i[a*e+s]=t[a][s]||0}return n?hi(i,{size:e,gridResolution:n}):r?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.size,r=void 0===n?2:n,i=e.startIndex,o=void 0===i?0:i,a=e.endIndex,s=void 0===a?t.length:a,c=e.normalize,u=void 0===c||c,l=t.slice(o,s);_i(l,r,0,s-o);var f=hi(l,{size:r,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(u){var p,h=bi(f);try{for(h.s();!(p=h.n()).done;){var d=p.value;Ci(d,r)}}catch(t){h.e(t)}finally{h.f()}}return f}(i,{size:e}):i}function Li(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Mi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mi(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Mi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ki(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ai(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ki(Object(n),!0).forEach((function(e){P()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ki(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ji(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Ei=function(t){l()(n,t);var e=ji(n);function n(t){return i()(this,n),e.call(this,Ai(Ai({},t),{},{attributes:{positions:{size:3,padding:18,initialize:!0,type:t.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}}))}return a()(n,[{key:"getGeometryFromBuffer",value:function(t){return this.normalize?c()(d()(n.prototype),"getGeometryFromBuffer",this).call(this,t):function(){return null}}},{key:"normalizeGeometry",value:function(t){return this.normalize?Oi(t,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):t}},{key:"get",value:function(t){return this.attributes[t]}},{key:"getGeometrySize",value:function(t){if(Array.isArray(t[0])){var e,n=0,r=Li(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;n+=this.getGeometrySize(i)}}catch(t){r.e(t)}finally{r.f()}return n}var o=this.getPathLength(t);return o<2?0:this.isClosed(t)?o<3?0:o+2:o}},{key:"updateGeometryAttributes",value:function(t,e){if(0!==e.geometrySize)if(t&&Array.isArray(t[0])){var n,r=Li(t);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=this.getGeometrySize(i);e.geometrySize=o,this.updateGeometryAttributes(i,e),e.vertexStart+=o}}catch(t){r.e(t)}finally{r.f()}}else this._updateSegmentTypes(t,e),this._updatePositions(t,e)}},{key:"_updateSegmentTypes",value:function(t,e){var n=this.attributes.segmentTypes,r=this.isClosed(t),i=e.vertexStart,o=e.geometrySize;n.fill(0,i,i+o),r?(n[i]=4,n[i+o-2]=4):(n[i]+=1,n[i+o-2]+=2),n[i+o-1]=4}},{key:"_updatePositions",value:function(t,e){var n=this.attributes.positions;if(n)for(var r=e.vertexStart,i=e.geometrySize,o=new Array(3),a=r,s=0;s<i;a++,s++)this.getPointOnPath(t,s,o),n[3*a]=o[0],n[3*a+1]=o[1],n[3*a+2]=o[2]}},{key:"getPathLength",value:function(t){return t.length/this.positionSize}},{key:"getPointOnPath",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this.positionSize;e*r>=t.length&&(e+=1-t.length/r);var i=e*r;return n[0]=t[i],n[1]=t[i+1],n[2]=3===r&&t[i+2]||0,n}},{key:"isClosed",value:function(t){if(!this.normalize)return this.opts.loop;var e=this.positionSize,n=t.length-e;return t[0]===t[n]&&t[1]===t[n+1]&&(2===e||t[2]===t[n+2])}}]),n}(g.Tesselator);function Ii(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Ri=[0,0,0,255],Ti={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},rounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:function(t){return t.path}},getColor:{type:"accessor",value:Ri},getWidth:{type:"accessor",value:1}},zi={enter:function(t,e){return e.length?e.subarray(e.length-t.length):t}},Fi=function(t){l()(n,t);var e=Ii(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getShaders",value:function(){return c()(d()(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float miterLimit;\nuniform bool billboard;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\nvec3 lineJoin(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  vec2 dir = isEnd ? dirA : dirB;\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * jointType * 4.0 * flipIfTrue(isStartCap), isJoint);\n  }\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return currPoint + offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.worldPosition = instanceStartPositions;\n  geometry.worldPositionAlt = instanceEndPositions;\n  geometry.pickingColor = instancePickingColors;\n\n  vec2 widthPixels = vec2(clamp(project_size_to_pixel(instanceStrokeWidths * widthScale),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  if (billboard) {\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 pos = lineJoin(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec4 pos = vec4(\n      lineJoin(prevPosition, currPosition, nextPosition, width.xy),\n      1.0);\n    geometry.position = pos;\n    gl_Position = project_common_position_to_clipspace(pos);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float jointType;\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    if (jointType > 0.0 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    if (jointType == 0.0 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[g.project32,g.picking]})}},{key:"initializeState",value:function(){var t=this;this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:zi,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:zi,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:zi,defaultValue:Ri},instancePickingColors:{size:3,type:5121,accessor:function(e,n){var r=n.index,i=n.target;return t.encodePickingColor(e&&e.__source?e.__source.index:r,i)}}}),this.setState({pathTesselator:new Ei({fp64:this.use64bitPositions()})}),this.props.getDashArray&&!this.props.extensions.length&&g.log.removed("getDashArray","PathStyleExtension")()}},{key:"updateState",value:function(t){var e=t.oldProps,r=t.props,i=t.changeFlags;c()(d()(n.prototype),"updateState",this).call(this,{props:r,oldProps:e,changeFlags:i});var o=this.getAttributeManager();if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPath)){var a=this.state.pathTesselator,s=r.data.attributes||{};a.updateGeometry({data:r.data,geometryBuffer:s.getPath,buffers:s,normalize:!r._pathType,loop:"loop"===r._pathType,getGeometry:r.getPath,positionFormat:r.positionFormat,wrapLongitude:r.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:i.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),i.dataChanged||o.invalidateAll()}if(i.extensionsChanged){var u=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(u)}),o.invalidateAll()}}},{key:"getPickingInfo",value:function(t){var e=c()(d()(n.prototype),"getPickingInfo",this).call(this,t),r=e.index,i=this.props.data;return i[0]&&i[0].__source&&(e.object=i.find((function(t){return t.__source.index===r}))),e}},{key:"draw",value:function(t){var e=t.uniforms,n=this.context.viewport,r=this.props,i=r.rounded,o=r.billboard,a=r.miterLimit,s=r.widthUnits,c=r.widthScale,u=r.widthMinPixels,l=r.widthMaxPixels,f="pixels"===s?n.metersPerPixel:1;this.state.model.setUniforms(Object.assign({},e,{jointType:Number(i),billboard:o,widthScale:c*f,miterLimit:a,widthMinPixels:u,widthMaxPixels:l})).draw()}},{key:"_getModel",value:function(t){return new v.Model(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new v.Geometry({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0}))}},{key:"calculatePositions",value:function(t){var e=this.state.pathTesselator;t.startIndices=e.vertexStarts,t.value=e.get("positions")}},{key:"calculateSegmentTypes",value:function(t){var e=this.state.pathTesselator;t.startIndices=e.vertexStarts,t.value=e.get("segmentTypes")}},{key:"wrapLongitude",get:function(){return!1}}]),n}(g.Layer);Fi.layerName="PathLayer",Fi.defaultProps=Ti;var Di=n(17),Ni=n.n(Di);function Wi(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ui(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ui(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ui(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Gi(t,e,n,r){for(var i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function Bi(t,e,n,r){for(var i=e,o=n.length,a=0;a<o;a++)for(var s=0;s<r;s++)t[i++]=n[a][s]||0;if(!function(t){var e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}(n))for(var c=0;c<r;c++)t[i++]=n[0][c]||0;return i}function Vi(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0,a=(o=o||n.length)-i;if(a<=0)return e;for(var s=e,c=0;c<a;c++)t[s++]=n[i+c];if(!Gi(n,r,i,o))for(var u=0;u<r;u++)t[s++]=n[i+u];return s}function Zi(t,e){!function(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}(t);var n=[],r=[];if(t.positions){var i=t,o=i.positions,a=i.holeIndices;if(a){for(var s=0,c=0;c<=a.length;c++)s=Vi(n,s,o,e,a[c-1],a[c]),r.push(s);return r.pop(),{positions:n,holeIndices:r}}t=o}if(Number.isFinite(t[0]))return Vi(n,0,t,e),n;if(!function(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}(t)){var u,l=0,f=Wi(t);try{for(f.s();!(u=f.n()).done;){l=Bi(n,l,u.value,e),r.push(l)}}catch(t){f.e(t)}finally{f.f()}return r.pop(),{positions:n,holeIndices:r}}return Bi(n,0,t,e),n}function Hi(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ki(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ki(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ki(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ji(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function qi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ji(Object(n),!0).forEach((function(e){P()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ji(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Xi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Yi=function(t){l()(n,t);var e=Xi(n);function n(t){i()(this,n);var r=t.fp64,o=t.IndexType,a=void 0===o?Uint32Array:o;return e.call(this,qi(qi({},t),{},{attributes:{positions:{size:3,type:r?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:a,size:1}}}))}return a()(n,[{key:"get",value:function(t){var e=this.attributes;return"indices"===t?e.indices&&e.indices.subarray(0,this.vertexCount):e[t]}},{key:"updateGeometry",value:function(t){c()(d()(n.prototype),"updateGeometry",this).call(this,t);var e=this.buffers.indices;e&&(this.vertexCount=(e.value||e).length)}},{key:"normalizeGeometry",value:function(t){if(this.normalize){if(t=Zi(t,this.positionSize),this.opts.resolution)return gi(t.positions||t,t.holeIndices,{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0});if(this.opts.wrapLongitude)return function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.size,i=void 0===r?2:r,o=n.normalize,a=void 0===o||o,s=n.edgeTypes,c=void 0!==s&&s;e=e||[];for(var u=[],l=[],f=0,p=0,h=0;h<=e.length;h++){for(var d=e[h]||t.length,g=p,v=Pi(t,i,f,d),y=v;y<d;y++)u[p++]=t[y];for(var m=f;m<v;m++)u[p++]=t[m];_i(u,i,g,p),Si(u,i,g,p,n.maxLatitude),f=d,l[h]=p}l.pop();var x=gi(u,l,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:c});if(a){var b,w=bi(x);try{for(w.s();!(b=w.n()).done;){var P=b.value;Ci(P.positions,i)}}catch(t){w.e(t)}finally{w.f()}}return x}(t.positions||t,t.holeIndices,{size:this.positionSize,maxLatitude:86,edgeTypes:!0})}return t}},{key:"getGeometrySize",value:function(t){if(Array.isArray(t)&&!Number.isFinite(t[0])){var e,n=0,r=Hi(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;n+=this.getGeometrySize(i)}}catch(t){r.e(t)}finally{r.f()}return n}return(t.positions||t).length/this.positionSize}},{key:"getGeometryFromBuffer",value:function(t){return this.normalize||!this.buffers.indices?c()(d()(n.prototype),"getGeometryFromBuffer",this).call(this,t):function(){return null}}},{key:"updateGeometryAttributes",value:function(t,e){if(Array.isArray(t)&&!Number.isFinite(t[0])){var n,r=Hi(t);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=this.getGeometrySize(i);e.geometrySize=o,this.updateGeometryAttributes(i,e),e.vertexStart+=o,e.indexStart=this.indexStarts[e.geometryIndex+1]}}catch(t){r.e(t)}finally{r.f()}}else this._updateIndices(t,e),this._updatePositions(t,e),this._updateVertexValid(t,e)}},{key:"_updateIndices",value:function(t,e){var n=e.geometryIndex,r=e.vertexStart,i=e.indexStart,o=this.attributes,a=this.indexStarts,s=this.typedArrayManager,c=o.indices;if(c){var u=i,l=function(t,e,n){var r=null;t.holeIndices&&(r=t.holeIndices.map((function(t){return t/e})));var i=t.positions||t;if(n){var o=i.length;i=i.slice();for(var a=[],s=0;s<o;s+=e){a[0]=i[s],a[1]=i[s+1];var c=n(a);i[s]=c[0],i[s+1]=c[1]}}return Ni()(i,r,e)}(t,this.positionSize,this.opts.preproject);c=s.allocate(c,i+l.length,{copy:!0});for(var f=0;f<l.length;f++)c[u++]=l[f]+r;a[n+1]=i+l.length,o.indices=c}}},{key:"_updatePositions",value:function(t,e){var n=e.vertexStart,r=e.geometrySize,i=this.attributes.positions,o=this.positionSize;if(i)for(var a=t.positions||t,s=n,c=0;c<r;s++,c++){var u=a[c*o],l=a[c*o+1],f=o>2?a[c*o+2]:0;i[3*s]=u,i[3*s+1]=l,i[3*s+2]=f}}},{key:"_updateVertexValid",value:function(t,e){var n=e.vertexStart,r=e.geometrySize,i=this.attributes.vertexValid,o=this.positionSize,a=t&&t.holeIndices;if(t&&t.edgeTypes?i.set(t.edgeTypes,n):i.fill(1,n,n+r),a)for(var s=0;s<a.length;s++)i[n+a[s]/o-1]=0;i[n+r-1]=0}}]),n}(g.Tesselator),$i="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n\n#ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n    geometry.normal = normal;\n  }\n\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",Qi="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat($i,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),to="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat($i,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = instancePositions;\n  props.positions64Low = instancePositions64Low;\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n  props.nextPositions = nextPositions;\n  props.nextPositions64Low = nextPositions64Low;\n\n  calculatePosition(props);\n}\n");function eo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var no=[0,0,0,255],ro={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:function(t){return t.polygon}},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:no},getLineColor:{type:"accessor",value:no},material:!0},io={enter:function(t,e){return e.length?e.subarray(e.length-t.length):t}},oo=function(t){l()(n,t);var e=eo(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getShaders",value:function(t){return c()(d()(n.prototype),"getShaders",this).call(this,{vs:"top"===t?Qi:to,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",defines:{},modules:[g.project32,g.gouraudLighting,g.picking]})}},{key:"initializeState",value:function(){var t=this,e=this.context,n=e.gl,r=e.viewport,i=this.props.coordinateSystem;r.isGeospatial&&i===g.COORDINATE_SYSTEM.DEFAULT&&(i=g.COORDINATE_SYSTEM.LNGLAT),this.setState({numInstances:0,polygonTesselator:new Yi({preproject:i===g.COORDINATE_SYSTEM.LNGLAT&&r.projectFlat,fp64:this.use64bitPositions(),IndexType:!n||Object(v.hasFeatures)(n,v.FEATURES.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});var o=this.getAttributeManager();o.remove(["instancePickingColors"]),o.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:!0},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:io,accessor:"getPolygon",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:!0},elevations:{size:1,transition:io,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{alias:"colors",size:this.props.colorFormat.length,type:5121,normalized:!0,transition:io,accessor:"getFillColor",defaultValue:no,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{alias:"colors",size:this.props.colorFormat.length,type:5121,normalized:!0,transition:io,accessor:"getLineColor",defaultValue:no,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:function(e,n){var r=n.index,i=n.target;return t.encodePickingColor(e&&e.__source?e.__source.index:r,i)},shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}},{key:"getPickingInfo",value:function(t){var e=c()(d()(n.prototype),"getPickingInfo",this).call(this,t),r=e.index,i=this.props.data;return i[0]&&i[0].__source&&(e.object=i.find((function(t){return t.__source.index===r}))),e}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.extruded,i=n.filled,o=n.wireframe,a=n.elevationScale,s=this.state,c=s.topModel,u=s.sideModel,l=s.polygonTesselator,f=Object.assign({},e,{extruded:Boolean(r),elevationScale:a});u&&(u.setInstanceCount(l.instanceCount-1),u.setUniforms(f),o&&(u.setDrawMode(3),u.setUniforms({isWireframe:!0}).draw()),i&&(u.setDrawMode(6),u.setUniforms({isWireframe:!1}).draw())),c&&(c.setVertexCount(l.vertexCount),c.setUniforms(f).draw())}},{key:"updateState",value:function(t){c()(d()(n.prototype),"updateState",this).call(this,t),this.updateGeometry(t);var e=t.props,r=t.oldProps,i=t.changeFlags,o=this.getAttributeManager();(i.extensionsChanged||e.filled!==r.filled||e.extruded!==r.extruded)&&(this.state.models&&this.state.models.forEach((function(t){return t.delete()})),this.setState(this._getModels(this.context.gl)),o.invalidateAll())}},{key:"updateGeometry",value:function(t){var e=t.props,n=(t.oldProps,t.changeFlags);if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){var r=this.state.polygonTesselator,i=e.data.attributes||{};r.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:i.getPolygon,buffers:i,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged}),this.setState({numInstances:r.instanceCount,startIndices:r.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}},{key:"_getModels",value:function(t){var e,n,r=this.props,i=r.id,o=r.filled,a=r.extruded;if(o){var s=this.getShaders("top");s.defines.NON_INSTANCED_MODEL=1,e=new v.Model(t,Object.assign({},s,{id:"".concat(i,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0}))}return a&&((n=new v.Model(t,Object.assign({},this.getShaders("side"),{id:"".concat(i,"-side"),geometry:new v.Geometry({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}))).userData.excludeAttributes={indices:!0}),{models:[n,e].filter(Boolean),topModel:e,sideModel:n}}},{key:"calculateIndices",value:function(t){var e=this.state.polygonTesselator;t.startIndices=e.indexStarts,t.value=e.get("indices")}},{key:"calculatePositions",value:function(t){var e=this.state.polygonTesselator;t.startIndices=e.vertexStarts,t.value=e.get("positions")}},{key:"calculateVertexValid",value:function(t){t.value=this.state.polygonTesselator.get("vertexValid")}},{key:"wrapLongitude",get:function(){return!1}}]),n}(g.Layer);function ao(t){for(var e=t.data,n=t.getIndex,r=t.dataRange,i=t.replace,o=r.startRow,a=void 0===o?0:o,s=r.endRow,c=void 0===s?1/0:s,u=e.length,l=u,f=u,p=0;p<u;p++){var h=n(e[p]);if(l>p&&h>=a&&(l=p),h>=c){f=p;break}}for(var d=l,g=f-l!==i.length,v=g&&e.slice(f),y=0;y<i.length;y++)e[d++]=i[y];if(g){for(var m=0;m<v.length;m++)e[d++]=v[m];e.length=d}return{startRow:l,endRow:l+i.length}}function so(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return co(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return co(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function co(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function uo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}oo.layerName="SolidPolygonLayer",oo.defaultProps=ro;var lo=[0,0,0,255],fo={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:function(t){return t.polygon}},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:lo},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0},po=function(t){l()(n,t);var e=uo(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"initializeState",value:function(){this.state={paths:[]},this.props.getLineDashArray&&g.log.removed("getLineDashArray","PathStyleExtension")()}},{key:"updateState",value:function(t){var e=this,n=(t.oldProps,t.props,t.changeFlags),r=n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon);if(r&&Array.isArray(n.dataChanged)){var i=this.state.paths.slice(),o=n.dataChanged.map((function(t){return ao({data:i,getIndex:function(t){return t.__source.index},dataRange:t,replace:e._getPaths(t)})}));this.setState({paths:i,pathsDiff:o})}else r&&this.setState({paths:this._getPaths(),pathsDiff:null})}},{key:"_getPaths",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.props,r=n.data,i=n.getPolygon,o=n.positionFormat,a=n._normalize,s=[],c="XY"===o?2:3,u=e.startRow,l=e.endRow,f=Object(g.createIterable)(r,u,l),p=f.iterable,h=f.objectInfo,d=so(p);try{for(d.s();!(t=d.n()).done;){var v=t.value;h.index++;var y=i(v,h);a&&(y=Zi(y,c));var m=y,x=m.holeIndices,b=y.positions||y;if(x)for(var w=0;w<=x.length;w++){var P=b.slice(x[w-1]||0,x[w]||b.length);s.push(this.getSubLayerRow({path:P},v,h.index))}else s.push(this.getSubLayerRow({path:b},v,h.index))}}catch(t){d.e(t)}finally{d.f()}return s}},{key:"renderLayers",value:function(){var t=this.props,e=t.data,n=t._dataDiff,r=t.stroked,i=t.filled,o=t.extruded,a=t.wireframe,s=t._normalize,c=t.elevationScale,u=t.transitions,l=t.positionFormat,f=this.props,p=f.lineWidthUnits,h=f.lineWidthScale,d=f.lineWidthMinPixels,g=f.lineWidthMaxPixels,v=f.lineJointRounded,y=f.lineMiterLimit,m=f.lineDashJustified,x=this.props,b=x.getFillColor,w=x.getLineColor,P=x.getLineWidth,S=x.getLineDashArray,_=x.getElevation,C=x.getPolygon,O=x.updateTriggers,L=x.material,M=this.state,k=M.paths,A=M.pathsDiff,j=this.getSubLayerClass("fill",oo),E=this.getSubLayerClass("stroke",Fi),I=this.shouldRenderSubLayer("fill",k)&&new j({_dataDiff:n,extruded:o,elevationScale:c,filled:i,wireframe:a,_normalize:s,getElevation:_,getFillColor:b,getLineColor:o&&a?w:lo,material:L,transitions:u},this.getSubLayerProps({id:"fill",updateTriggers:{getPolygon:O.getPolygon,getElevation:O.getElevation,getFillColor:O.getFillColor,lineColors:o&&a,getLineColor:O.getLineColor}}),{data:e,positionFormat:l,getPolygon:C});return[!o&&I,!o&&r&&this.shouldRenderSubLayer("stroke",k)&&new E({_dataDiff:A&&function(){return A},widthUnits:p,widthScale:h,widthMinPixels:d,widthMaxPixels:g,rounded:v,miterLimit:y,dashJustified:m,_pathType:"loop",transitions:u&&{getWidth:u.getLineWidth,getColor:u.getLineColor,getPath:u.getPolygon},getColor:this.getSubLayerAccessor(w),getWidth:this.getSubLayerAccessor(P),getDashArray:this.getSubLayerAccessor(S)},this.getSubLayerProps({id:"stroke",updateTriggers:{getWidth:O.getLineWidth,getColor:O.getLineColor,getDashArray:O.getLineDashArray}}),{data:k,positionFormat:l,getPath:function(t){return t.path}}),o&&I]}}]),n}(g.CompositeLayer);function ho(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},i=n.startRow,o=void 0===i?0:i,a=n.endRow,s=void 0===a?t.length:a,c=o;c<s;c++){var u=t[c];g.log.assert(u&&u.geometry,"GeoJSON does not have geometry");var l=u.geometry;if("GeometryCollection"===l.type){g.log.assert(Array.isArray(l.geometries),"GeoJSON does not have geometries array");for(var f=l.geometries,p=0;p<f.length;p++){var h=f[p];go(h,r,e,u,c)}}else go(l,r,e,u,c)}return r}function go(t,e,n,r,i){var o=t.type,a=t.coordinates,s=e.pointFeatures,c=e.lineFeatures,u=e.polygonFeatures,l=e.polygonOutlineFeatures;if(function(t,e){var n=vo[t];g.log.assert(n,"Unknown GeoJSON type ".concat(t));for(;e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}(o,a))switch(o){case"Point":s.push(n({geometry:t},r,i));break;case"MultiPoint":a.forEach((function(t){s.push(n({geometry:{type:"Point",coordinates:t}},r,i))}));break;case"LineString":c.push(n({geometry:t},r,i));break;case"MultiLineString":a.forEach((function(t){c.push(n({geometry:{type:"LineString",coordinates:t}},r,i))}));break;case"Polygon":u.push(n({geometry:t},r,i)),a.forEach((function(t){l.push(n({geometry:{type:"LineString",coordinates:t}},r,i))}));break;case"MultiPolygon":a.forEach((function(t){u.push(n({geometry:{type:"Polygon",coordinates:t}},r,i)),t.forEach((function(t){l.push(n({geometry:{type:"LineString",coordinates:t}},r,i))}))}))}else g.log.warn("".concat(o," coordinates are malformed"))()}po.layerName="PolygonLayer",po.defaultProps=fo;var vo={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function yo(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return mo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mo(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function mo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function xo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var bo=[0,0,0,255],wo={stroked:!0,filled:!0,extruded:!1,wireframe:!1,lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,elevationScale:1,pointRadiusUnits:"meters",pointRadiusScale:1,pointRadiusMinPixels:0,pointRadiusMaxPixels:Number.MAX_SAFE_INTEGER,getLineColor:{type:"accessor",value:bo},getFillColor:{type:"accessor",value:[0,0,0,255]},getRadius:{type:"accessor",value:1},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};function Po(t){return t.geometry.coordinates}var So=function(t){l()(n,t);var e=xo(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"initializeState",value:function(){this.state={features:{}},this.props.getLineDashArray&&g.log.removed("getLineDashArray","PathStyleExtension")()}},{key:"updateState",value:function(t){var e=t.props,n=t.changeFlags;if(n.dataChanged){var r=function(t){if(Array.isArray(t))return t;switch(g.log.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return g.log.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}(e.data),i=this.getSubLayerRow.bind(this);if(Array.isArray(n.dataChanged)){var o=this.state.features,a={},s={};for(var c in o)a[c]=o[c].slice(),s[c]=[];var u,l=yo(n.dataChanged);try{for(l.s();!(u=l.n()).done;){var f=u.value,p=ho(r,i,f);for(var h in o)s[h].push(ao({data:a[h],getIndex:function(t){return t.__source.index},dataRange:f,replace:p[h]}))}}catch(t){l.e(t)}finally{l.f()}this.setState({features:a,featuresDiff:s})}else this.setState({features:ho(r,i),featuresDiff:{}})}}},{key:"renderLayers",value:function(){var t=this.state,e=t.features,n=t.featuresDiff,r=e.pointFeatures,i=e.lineFeatures,o=e.polygonFeatures,a=e.polygonOutlineFeatures,s=this.props,c=s.stroked,u=s.filled,l=s.extruded,f=s.wireframe,p=s.material,h=s.transitions,d=this.props,g=d.lineWidthUnits,v=d.lineWidthScale,y=d.lineWidthMinPixels,m=d.lineWidthMaxPixels,x=d.lineJointRounded,b=d.lineMiterLimit,w=d.pointRadiusUnits,P=d.pointRadiusScale,S=d.pointRadiusMinPixels,_=d.pointRadiusMaxPixels,C=d.elevationScale,O=d.lineDashJustified,L=this.props,M=L.getLineColor,k=L.getFillColor,A=L.getRadius,j=L.getLineWidth,E=L.getLineDashArray,I=L.getElevation,R=L.updateTriggers,T=this.getSubLayerClass("polygons-fill",oo),z=this.getSubLayerClass("polygons-stroke",Fi),F=this.getSubLayerClass("line-strings",Fi),D=this.getSubLayerClass("points",Xr),N=this.shouldRenderSubLayer("polygons-fill",o)&&new T({_dataDiff:n.polygonFeatures&&function(){return n.polygonFeatures},extruded:l,elevationScale:C,filled:u,wireframe:f,material:p,getElevation:this.getSubLayerAccessor(I),getFillColor:this.getSubLayerAccessor(k),getLineColor:this.getSubLayerAccessor(l&&f?M:bo),transitions:h&&{getPolygon:h.geometry,getElevation:h.getElevation,getFillColor:h.getFillColor,getLineColor:h.getLineColor}},this.getSubLayerProps({id:"polygons-fill",updateTriggers:{getElevation:R.getElevation,getFillColor:R.getFillColor,lineColors:l&&f,getLineColor:R.getLineColor}}),{data:o,getPolygon:Po});return[!l&&N,!l&&c&&this.shouldRenderSubLayer("polygons-stroke",a)&&new z({_dataDiff:n.polygonOutlineFeatures&&function(){return n.polygonOutlineFeatures},widthUnits:g,widthScale:v,widthMinPixels:y,widthMaxPixels:m,rounded:x,miterLimit:b,dashJustified:O,getColor:this.getSubLayerAccessor(M),getWidth:this.getSubLayerAccessor(j),getDashArray:this.getSubLayerAccessor(E),transitions:h&&{getPath:h.geometry,getColor:h.getLineColor,getWidth:h.getLineWidth}},this.getSubLayerProps({id:"polygons-stroke",updateTriggers:{getColor:R.getLineColor,getWidth:R.getLineWidth,getDashArray:R.getLineDashArray}}),{data:a,getPath:Po}),this.shouldRenderSubLayer("linestrings",i)&&new F({_dataDiff:n.lineFeatures&&function(){return n.lineFeatures},widthUnits:g,widthScale:v,widthMinPixels:y,widthMaxPixels:m,rounded:x,miterLimit:b,dashJustified:O,getColor:this.getSubLayerAccessor(M),getWidth:this.getSubLayerAccessor(j),getDashArray:this.getSubLayerAccessor(E),transitions:h&&{getPath:h.geometry,getColor:h.getLineColor,getWidth:h.getLineWidth}},this.getSubLayerProps({id:"line-strings",updateTriggers:{getColor:R.getLineColor,getWidth:R.getLineWidth,getDashArray:R.getLineDashArray}}),{data:i,getPath:Po}),this.shouldRenderSubLayer("points",r)&&new D({_dataDiff:n.pointFeatures&&function(){return n.pointFeatures},stroked:c,filled:u,radiusUnits:w,radiusScale:P,radiusMinPixels:S,radiusMaxPixels:_,lineWidthUnits:g,lineWidthScale:v,lineWidthMinPixels:y,lineWidthMaxPixels:m,getFillColor:this.getSubLayerAccessor(k),getLineColor:this.getSubLayerAccessor(M),getRadius:this.getSubLayerAccessor(A),getLineWidth:this.getSubLayerAccessor(j),transitions:h&&{getPosition:h.geometry,getFillColor:h.getFillColor,getLineColor:h.getLineColor,getRadius:h.getRadius,getLineWidth:h.getLineWidth}},this.getSubLayerProps({id:"points",updateTriggers:{getFillColor:R.getFillColor,getLineColor:R.getLineColor,getRadius:R.getRadius,getLineWidth:R.getLineWidth}}),{data:r,getPosition:Po,highlightedObjectIndex:this._getHighlightedIndex(r)}),l&&N]}},{key:"_getHighlightedIndex",value:function(t){var e=this.props.highlightedObjectIndex;return Number.isFinite(e)?t.findIndex((function(t){return t.__source.index===e})):null}}]),n}(g.CompositeLayer);So.layerName="GeoJsonLayer",So.defaultProps=wo;var _o=n(18),Co=n.n(_o);function Oo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var Lo=[],Mo=function(t){l()(n,t);var e=Oo(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getShaders",value:function(){return Object.assign({},c()(d()(n.prototype),"getShaders",this).call(this),{inject:{"vs:#decl":"\n  uniform float gamma;\n  varying float vGamma;\n","vs:#main-end":"\n  vGamma = gamma / (sizeScale * iconSize.y);\n"},fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float buffer;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform bool shouldDrawBackground;\nuniform vec3 backgroundColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying float vGamma;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    if (sdf) {\n      alpha = smoothstep(buffer - vGamma, buffer + vGamma, alpha);\n    }\n    float a = alpha * vColor.a;\n    \n    if (a < alphaCutoff) {\n      if (shouldDrawBackground) {\n        gl_FragColor = vec4(backgroundColor, vColor.a);\n      } else {\n        discard;\n      }\n    } else {\n      if (shouldDrawBackground) {\n        gl_FragColor = vec4(mix(backgroundColor, vColor.rgb, alpha), vColor.a * opacity);\n      } else {\n        gl_FragColor = vec4(vColor.rgb, a * opacity);\n      }\n      DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n    }\n  } else {\n    DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n  }\n}\n"})}},{key:"initializeState",value:function(){var t=this;c()(d()(n.prototype),"initializeState",this).call(this),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:function(e,n){var r=n.index,i=n.target;return t.encodePickingColor(r,i)}}})}},{key:"updateState",value:function(t){c()(d()(n.prototype),"updateState",this).call(this,t);var e=t.oldProps,r=t.props;if(r.backgroundColor!==e.backgroundColor){var i=Array.isArray(r.backgroundColor)?r.backgroundColor.map((function(t){return t/255})).slice(0,3):null;this.setState({backgroundColor:i})}}},{key:"draw",value:function(t){var e=t.uniforms,r=this.props.sdf,i=this.state.backgroundColor,o=Array.isArray(i);c()(d()(n.prototype),"draw",this).call(this,{uniforms:Object.assign({},e,{buffer:.75,gamma:.2,sdf:Boolean(r),backgroundColor:i||[0,0,0],shouldDrawBackground:o})})}},{key:"getInstanceOffset",value:function(t){var e=this;return t?Array.from(t).map((function(t){return c()(d()(n.prototype),"getInstanceOffset",e).call(e,t)})):Lo}},{key:"getInstanceColorMode",value:function(t){return 1}},{key:"getInstanceIconFrame",value:function(t){var e=this;return t?Array.from(t).map((function(t){return c()(d()(n.prototype),"getInstanceIconFrame",e).call(e,t)})):Lo}}]),n}(Dr);Mo.layerName="MultiIconLayer",Mo.defaultProps={backgroundColor:{type:"color",value:null,optional:!0},getIconOffsets:{type:"accessor",value:function(t){return t.offsets}},alphaCutoff:.001};var ko=n(19),Ao=n.n(ko);function jo(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Eo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Eo(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Eo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Io=[];function Ro(t,e,n,r){for(var i=0,o=e;o<n;o++){var a=t[o],s=null,c=r&&r[a];c&&(s=c.width),i+=s}return i}function To(t,e,n,r,i,o){for(var a=e,s=0,c=e;c<n;c++){var u=Ro(t,c,c+1,i);s+u>r&&(a<c&&o.push(c),a=c,s=0),s+=u}return s}function zo(t,e,n,r,i,o){for(var a=e,s=e,c=e,u=0,l=e;l<n;l++)if(" "===t[l]?c=l+1:" "!==t[l+1]&&l+1!==n||(c=l+1),c>s){var f=Ro(t,s,c,i);u+f>r&&(a<s&&(o.push(s),a=s,u=0),f>r&&(f=To(t,s,c,r,i,o),a=o[o.length-1])),s=c,u+=f}return u}function Fo(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0;void 0===o&&(o=t.length);var a=[];return"break-all"===e?To(t,i,o,n,r,a):zo(t,i,o,n,r,a),a}function Do(t,e,n,r,i,o){for(var a=0,s=0,c=e;c<n;c++){var u=t[c],l=r[u];l?(s||(s=l.height),i[c]=a+l.width/2,a+=l.width):(g.log.warn("Missing character: ".concat(u," (").concat(u.codePointAt(0),")"))(),i[c]=a,a+=32)}o[0]=a,o[1]=s}var No=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;i()(this,t),this.limit=e,this.clear()}return a()(t,[{key:"clear",value:function(){this._cache={},this._order=[]}},{key:"get",value:function(t){var e=this._cache[t];return e&&(this._deleteOrder(t),this._appendOrder(t)),e}},{key:"set",value:function(t,e){this._cache[t]?(this.delete(t),this._cache[t]=e,this._appendOrder(t)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[t]=e,this._appendOrder(t))}},{key:"delete",value:function(t){this._cache[t]&&(this._deleteCache(t),this._deleteOrder(t))}},{key:"_deleteCache",value:function(t){delete this._cache[t]}},{key:"_deleteOrder",value:function(t){var e=this._order.findIndex((function(e){return e===t}));e>=0&&this._order.splice(e,1)}},{key:"_appendOrder",value:function(t){this._order.push(t)}}]),t}();function Wo(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Uo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Uo(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Uo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Go=function(){for(var t=[],e=32;e<128;e++)t.push(String.fromCharCode(e));return t}(),Bo=new No(3),Vo=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function Zo(t,e){var n=Bo.get(t);if(!n)return e;var r=[],i=n.mapping,o=Object.keys(i);o=new Set(o);var a=e;return a instanceof Array&&(a=new Set(a)),a.forEach((function(t){o.has(t)||r.push(t)})),r}function Ho(t,e){for(var n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function Ko(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="baseline",t.textAlign="left"}var Jo=function(){function t(){i()(this,t),this.props={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:Go,fontSize:64,buffer:2,sdf:!1,cutoff:.25,radius:3},this._key=null,this._atlas=null}return a()(t,[{key:"setProps",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Vo.forEach((function(n){n in e&&(t.props[n]=e[n])}));var n=this._key;this._key=this._getKey();var r=Zo(this._key,this.props.characterSet),i=Bo.get(this._key);if(i&&0===r.length)this._key!==n&&(this._atlas=i);else{var o=this._generateFontAtlas(this._key,r,i);this._atlas=o,Bo.set(this._key,o)}}},{key:"_generateFontAtlas",value:function(t,e,n){var r=this.props,i=r.fontFamily,o=r.fontWeight,a=r.fontSize,s=r.buffer,c=r.sdf,u=r.radius,l=r.cutoff,f=n&&n.data;f||((f=document.createElement("canvas")).width=1024);var p=f.getContext("2d");Ko(p,i,a,o);var h=function(t){var e,n=t.characterSet,r=t.getFontWidth,i=t.fontHeight,o=t.buffer,a=t.maxCanvasWidth,s=t.mapping,c=void 0===s?{}:s,u=t.xOffset,l=void 0===u?0:u,f=t.yOffset,p=void 0===f?0:f,h=0,d=l,g=0,v=jo(n);try{for(v.s();!(e=v.n()).done;){var y=e.value;if(!c[y]){var m=r(y,g++);d+m+2*o>a&&(d=0,h++),c[y]={x:d+o,y:p+h*(i+2*o)+o,width:m,height:i},d+=m+2*o}}}catch(t){v.e(t)}finally{v.f()}var x,b=i+2*o;return{mapping:c,xOffset:d,yOffset:p+h*b,canvasHeight:(x=p+(h+1)*b,Math.pow(2,Math.ceil(Math.log2(x))))}}(Object.assign({getFontWidth:function(t){return p.measureText(t).width},fontHeight:1.2*a,buffer:s,characterSet:e,maxCanvasWidth:1024},n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset})),d=h.mapping,g=h.canvasHeight,v=h.xOffset,y=h.yOffset;if(f.height!==g){var m=p.getImageData(0,0,f.width,f.height);f.height=g,p.putImageData(m,0,0)}if(Ko(p,i,a,o),c){var x,b=new Ao.a(a,s,u,l,i,o),w=p.getImageData(0,0,b.size,b.size),P=Wo(e);try{for(P.s();!(x=P.n()).done;){var S=x.value;Ho(b.draw(S),w),p.putImageData(w,d[S].x-s,d[S].y-s)}}catch(t){P.e(t)}finally{P.f()}}else{var _,C=Wo(e);try{for(C.s();!(_=C.n()).done;){var O=_.value;p.fillText(O,d[O].x,d[O].y+.9*a)}}catch(t){C.e(t)}finally{C.f()}}return{xOffset:v,yOffset:y,mapping:d,data:f,width:f.width,height:f.height}}},{key:"_getKey",value:function(){var t=this.props,e=t.fontFamily,n=t.fontWeight,r=t.fontSize,i=t.buffer,o=t.sdf,a=t.radius,s=t.cutoff;return o?"".concat(e," ").concat(n," ").concat(r," ").concat(i," ").concat(a," ").concat(s):"".concat(e," ").concat(n," ").concat(r," ").concat(i)}},{key:"texture",get:function(){return this._atlas}},{key:"mapping",get:function(){return this._atlas&&this._atlas.mapping}},{key:"scale",get:function(){return 1.2}}]),t}();function qo(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Xo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xo(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Xo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Yo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Yo(Object(n),!0).forEach((function(e){P()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Yo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Qo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var ta={fontSize:64,buffer:2,sdf:!1,radius:3,cutoff:.25},ea={start:1,middle:0,end:-1},na={top:1,center:0,bottom:-1},ra=["fontSize","buffer","sdf","radius","cutoff"],ia={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,backgroundColor:{type:"color",value:null,optional:!0},characterSet:Go,fontFamily:"Monaco, monospace",fontWeight:"normal",lineHeight:1,fontSettings:{},wordBreak:"word-break",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:function(t){return t.text}},getPosition:{type:"accessor",value:function(t){return t.position}},getColor:{type:"accessor",value:[0,0,0,255]},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]}},oa=function(t){l()(n,t);var e=Qo(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"initializeState",value:function(){this.state={styleVersion:0,fontAtlasManager:new Jo}}},{key:"updateState",value:function(t){var e=t.props,n=t.oldProps,r=t.changeFlags,i=this._fontChanged(n,e);i&&this._updateFontAtlas(n,e);var o=i||e.lineHeight!==n.lineHeight||e.wordBreak!==n.wordBreak||e.maxWidth!==n.maxWidth;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText(),o&&this.setState({styleVersion:this.state.styleVersion+1})}},{key:"getPickingInfo",value:function(t){var e=t.info;return Object.assign(e,{object:e.index>=0?this.props.data[e.index]:null})}},{key:"_updateFontAtlas",value:function(t,e){var n=e.characterSet,r=e.fontSettings,i=e.fontFamily,o=e.fontWeight;this.state.fontAtlasManager.setProps(Object.assign({},ta,r,{characterSet:n,fontFamily:i,fontWeight:o})),this.setNeedsRedraw(!0)}},{key:"_fontChanged",value:function(t,e){if(t.fontFamily!==e.fontFamily||t.characterSet!==e.characterSet||t.fontWeight!==e.fontWeight)return!0;if(t.fontSettings===e.fontSettings)return!1;var n=t.fontSettings||{},r=e.fontSettings||{};return ra.some((function(t){return n[t]!==r[t]}))}},{key:"_updateText",value:function(){var t,e=this.props.data,n=e.attributes&&e.attributes.getText,r=this.props.getText,i=e.startIndices;if(n&&i){var o=function(t){var e=t.value,n=t.length,r=t.stride,i=t.offset,o=t.startIndices,a=e.BYTES_PER_ELEMENT,s=r?r/a:1,c=i?i/a:0,u=o[n]||Math.floor((e.length-c-a)/s)+1,l=new Array(n),f=e;if(s>1||c>0){f=new e.constructor(u);for(var p=0;p<u;p++)f[p]=e[p*s+c]}for(var h=0;h<n;h++){var d=o[h],g=o[h+1]||u;l[h]=String.fromCodePoint.apply(null,f.subarray(d,g))}return{texts:l,characterCount:u}}($o($o({},ArrayBuffer.isView(n)?{value:n}:n),{},{length:e.length,startIndices:i})),a=o.texts;t=o.characterCount,r=function(t,e){var n=e.index;return a[n]}}else{var s=Object(g.createIterable)(e),c=s.iterable,u=s.objectInfo;i=[0],t=0;var l,f=qo(c);try{for(f.s();!(l=f.n()).done;){var p=l.value;u.index++;var h=r(p,u)||"";t+=Array.from(h).length,i.push(t)}}catch(t){f.e(t)}finally{f.f()}}this.setState({getText:r,startIndices:i,numInstances:t})}},{key:"getIconOffsets",value:function(t,e){for(var n=this.state.fontAtlasManager.mapping,r=this.state.getText,i=this.props,o=i.wordBreak,a=i.maxWidth,s=i.lineHeight,c=i.getTextAnchor,u=i.getAlignmentBaseline,l=function(t,e,n,r,i){for(var o=(t=Array.from(t)).length,a=new Array(o),s=new Array(o),c=new Array(o),u=("break-word"===n||"break-all"===n)&&isFinite(r)&&r>0,l=[0,0],f=[],p=0,h=0,d=0,g=0;g<=o;g++){var v=t[g];if("\n"!==v&&g!==o||(d=g),d>h){for(var y=u?Fo(t,n,r,i,h,d):Io,m=0;m<=y.length;m++){var x=0===m?h:y[m-1],b=m<y.length?y[m]:d;Do(t,x,b,i,a,f);for(var w=x;w<b;w++)s[w]=p+f[1]/2,c[w]=f[0];p+=f[1]*e,l[0]=u?r:Math.max(l[0],f[0])}h=d}"\n"===v&&(a[h]=0,s[h]=0,c[h]=0,h++)}return l[1]=p,{x:a,y:s,rowWidth:c,size:l}}(r(t,e)||"",s,o,a,n),f=l.x,p=l.y,h=l.rowWidth,d=Co()(l.size,2),g=d[0],v=d[1],y=ea["function"==typeof c?c(t,e):c],m=na["function"==typeof u?u(t,e):u],x=f.length,b=new Array(2*x),w=0,P=0;P<x;P++){var S=(1-y)*(g-h[P])/2;b[w++]=(y-1)*g/2+S+f[P],b[w++]=(m-1)*v/2+p[P]}return b}},{key:"renderLayers",value:function(){var t=this.state,e=t.startIndices,n=t.numInstances,r=t.getText,i=t.fontAtlasManager,o=i.scale,a=i.texture,s=i.mapping,c=t.styleVersion,u=this.props,l=u.data,f=u._dataDiff,p=u.backgroundColor,h=u.getPosition,d=u.getColor,g=u.getSize,v=u.getAngle,y=u.getPixelOffset,m=u.billboard,x=u.fontSettings,b=u.sizeScale,w=u.sizeUnits,P=u.sizeMinPixels,S=u.sizeMaxPixels,_=u.transitions,C=u.updateTriggers,O=this.getIconOffsets.bind(this);return new(this.getSubLayerClass("characters",Mo))({sdf:x.sdf,iconAtlas:a,iconMapping:s,backgroundColor:p,getPosition:h,getColor:d,getSize:g,getAngle:v,getPixelOffset:y,billboard:m,sizeScale:b*o,sizeUnits:w,sizeMinPixels:P*o,sizeMaxPixels:S*o,transitions:_&&{getPosition:_.getPosition,getAngle:_.getAngle,getColor:_.getColor,getSize:_.getSize,getPixelOffset:_.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:C.getText,getPosition:C.getPosition,getAngle:C.getAngle,getColor:C.getColor,getSize:C.getSize,getPixelOffset:C.getPixelOffset,getIconOffsets:{getText:C.getText,getTextAnchor:C.getTextAnchor,getAlignmentBaseline:C.getAlignmentBaseline,styleVersion:c}}}),{data:l,_dataDiff:f,startIndices:e,numInstances:n,getIconOffsets:O,getIcon:r})}}]),n}(g.CompositeLayer);oa.layerName="TextLayer",oa.defaultProps=ia,n.d(e,"ArcLayer",(function(){return b})),n.d(e,"BitmapLayer",(function(){return ht})),n.d(e,"IconLayer",(function(){return Dr})),n.d(e,"LineLayer",(function(){return Ur})),n.d(e,"PointCloudLayer",(function(){return Hr})),n.d(e,"ScatterplotLayer",(function(){return Xr})),n.d(e,"ColumnLayer",(function(){return oi})),n.d(e,"GridCellLayer",(function(){return si})),n.d(e,"PathLayer",(function(){return Fi})),n.d(e,"PolygonLayer",(function(){return po})),n.d(e,"GeoJsonLayer",(function(){return So})),n.d(e,"TextLayer",(function(){return oa})),n.d(e,"SolidPolygonLayer",(function(){return oo})),n.d(e,"_MultiIconLayer",(function(){return Mo}))}])}));